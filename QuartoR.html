<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>QuartoR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="QuartoR_files/libs/clipboard/clipboard.min.js"></script>
<script src="QuartoR_files/libs/quarto-html/quarto.js"></script>
<script src="QuartoR_files/libs/quarto-html/popper.min.js"></script>
<script src="QuartoR_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="QuartoR_files/libs/quarto-html/anchor.min.js"></script>
<link href="QuartoR_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="QuartoR_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="QuartoR_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="QuartoR_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="QuartoR_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="QuartoR_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="QuartoR_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="QuartoR_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="QuartoR_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="QuartoR_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="QuartoR_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="QuartoR_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="QuartoR_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="QuartoR_files/libs/leaflet-binding-2.2.1/leaflet.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">QuartoR</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="analyzing-and-visualizing-ridership" class="level1">
<h1>Analyzing and Visualizing Ridership</h1>
<p><strong>Realized by : Heni Walha, Anis Bouhamed , Ian Collet , Mayssa Bouzid , Mariem Mazouz</strong></p>
<section id="patterns-in-île-de-france-rail-network" class="level2">
<h2 class="anchored" data-anchor-id="patterns-in-île-de-france-rail-network">Patterns in Île-de-France Rail Network</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsconnect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rsconnect'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:shiny':

    serverInfo</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-collection-and-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-collection-and-cleaning">1. Data Collection and Cleaning</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Directory where the CSV files are located</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_directory <span class="ot">&lt;-</span> <span class="st">"./data"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#all TXT files in the specified directory</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>txt_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> data_directory, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(txt_files)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "./data/2017_S1_NB_FER.txt"                                                   
 [2] "./data/2017_S2_NB_FER.txt"                                                   
 [3] "./data/2018_S1_NB_FER.txt"                                                   
 [4] "./data/2018_S2_NB_FER.txt"                                                   
 [5] "./data/2019_S1_NB_FER.txt"                                                   
 [6] "./data/2019_S2_NB_FER.txt"                                                   
 [7] "./data/2020_S1_NB_FER.txt"                                                   
 [8] "./data/2020_S2_NB_FER.txt"                                                   
 [9] "./data/2021_S1_NB_FER.txt"                                                   
[10] "./data/2021_S2_NB_FER.txt"                                                   
[11] "./data/2022_S1_NB_FER.txt"                                                   
[12] "./data/2022_S2_NB_FER.txt"                                                   
[13] "./data/validations-reseau-ferre-nombre-validations-par-jour-1er-semestre.csv"
[14] "./data/zones-d-arrets.xlsx"                                                  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty data frame to store the merged data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>merged_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data frame with 0 columns and 0 rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each TXT file and merge it into the main dataset</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (txt_file <span class="cf">in</span> txt_files) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read the first few lines to determine the separator</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  first_lines <span class="ot">&lt;-</span> <span class="fu">readLines</span>(txt_file, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  possible_separators <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="st">";"</span>)  </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable to control whether to continue to the next separator</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  continue_next_separator <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try each possible separator</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (separator <span class="cf">in</span> possible_separators) {</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>continue_next_separator) {</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>(</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        year_data <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(txt_file, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> separator, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="st">"lda"</span> <span class="sc">%in%</span> <span class="fu">names</span>(year_data)) {</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">names</span>(year_data)[<span class="fu">names</span>(year_data) <span class="sc">==</span> <span class="st">"lda"</span>] <span class="ot">&lt;-</span> <span class="st">"ID_REFA_LDA"</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert relevant columns to character</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        year_data<span class="sc">$</span>ID_REFA_LDA <span class="ot">&lt;-</span> <span class="fu">as.character</span>(year_data<span class="sc">$</span>ID_REFA_LDA)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        year_data<span class="sc">$</span>NB_VALD <span class="ot">&lt;-</span> <span class="fu">as.character</span>(year_data<span class="sc">$</span>NB_VALD)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Merge data</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        merged_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(merged_data, year_data)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set the variable to false to break out of the loop</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>        continue_next_separator <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Continue to the next separator if an error occurs</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>        continue_next_separator <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(txt_file, n = 5): line 1 appears to contain an embedded
nul</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(txt_file, n = 5): line 5 appears to contain an embedded
nul</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in read.table(file = file, header = header, sep = sep, quote = quote, :
line 1 appears to contain embedded nulls</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in read.table(file = file, header = header, sep = sep, quote = quote, :
line 5 appears to contain embedded nulls</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,
: EOF within quoted string</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,
: embedded nul(s) found in input</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in read.table(file = file, header = header, sep = sep, quote = quote, :
line 1 appears to contain embedded nulls</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in read.table(file = file, header = header, sep = sep, quote = quote, :
line 5 appears to contain embedded nulls</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,
: EOF within quoted string</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,
: embedded nul(s) found in input</code></pre>
</div>
</div>
<ul>
<li><em>We found that the NB_VALD column contains “Moins de 5” values which can’t be converted to integers. We replaced these values by 0 because anything less than 5 is irrelevant.</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerical columns to convert</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cols_to_convert <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CODE_STIF_TRNS"</span>, <span class="st">"CODE_STIF_RES"</span>, <span class="st">"CODE_STIF_ARRET"</span>, <span class="st">"NB_VALD"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing "Moins de 5" by 0 for the NB_VALD column</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NB_VALD =</span> <span class="fu">ifelse</span>(NB_VALD <span class="sc">==</span> <span class="st">"Moins de 5"</span>, <span class="dv">0</span>, <span class="fu">as.integer</span>(NB_VALD)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `NB_VALD = ifelse(NB_VALD == "Moins de 5", 0,
  as.integer(NB_VALD))`.
Caused by warning in `ifelse()`:
! NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion to integers, otherwise to NA</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(cols_to_convert), as.integer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(cols_to_convert)

  # Now:
  data %&gt;% select(all_of(cols_to_convert))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 2 warnings in `mutate()`.
The first warning was:
ℹ In argument: `CODE_STIF_RES = .Primitive("as.integer")(CODE_STIF_RES)`.
Caused by warning:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(merged_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        JOUR CODE_STIF_TRNS CODE_STIF_RES CODE_STIF_ARRET LIBELLE_ARRET
1 01/01/2017            100           110               1 PORTE MAILLOT
2 01/01/2017            100           110               1 PORTE MAILLOT
3 01/01/2017            100           110               1 PORTE MAILLOT
4 01/01/2017            100           110               1 PORTE MAILLOT
5 01/01/2017            100           110               1 PORTE MAILLOT
6 01/01/2017            100           110               1 PORTE MAILLOT
  ID_REFA_LDA CATEGORIE_TITRE NB_VALD
1       71379       AMETHYSTE     109
2       71379     AUTRE TITRE      61
3       71379             FGT     184
4       71379       IMAGINE R     915
5       71379          NAVIGO    2768
6       71379             TST     178</code></pre>
</div>
</div>
<ul>
<li>We found that there are some columns with ‘?’ values. These columns were ID_REFA_LDA and CATEGORIE_TITRE. For the CATEGORIE_TITRE column we converted it to “INCONNUE” in order to not lose too many lines of data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the empty values to NA</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>merged_data[merged_data <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "?" with NA in the column ID_REFA_LDA</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID_REFA_LDA =</span> <span class="fu">ifelse</span>(ID_REFA_LDA <span class="sc">==</span> <span class="st">"?"</span>, <span class="cn">NA</span>, ID_REFA_LDA))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "?" with NA in the column CATEGORIE_TITRE</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CATEGORIE_TITRE =</span> <span class="fu">ifelse</span>(CATEGORIE_TITRE <span class="sc">==</span> <span class="st">"?"</span>, <span class="st">"INCONNUE"</span>, CATEGORIE_TITRE))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of missing values for each column</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(merged_data))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           JOUR  CODE_STIF_TRNS   CODE_STIF_RES CODE_STIF_ARRET   LIBELLE_ARRET 
              0               0           15716           15716               0 
    ID_REFA_LDA CATEGORIE_TITRE         NB_VALD 
           3578               0               0 </code></pre>
</div>
</div>
<ul>
<li>Deleting NA values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete missing values</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(merged_data)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of missing values in every column</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(merged_data))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           JOUR  CODE_STIF_TRNS   CODE_STIF_RES CODE_STIF_ARRET   LIBELLE_ARRET 
              0               0               0               0               0 
    ID_REFA_LDA CATEGORIE_TITRE         NB_VALD 
              0               0               0 </code></pre>
</div>
</div>
<ul>
<li>remove redundant lines</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data[<span class="sc">!</span><span class="fu">duplicated</span>(merged_data), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>Checking outliers</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_data<span class="sc">$</span>NB_VALD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> merged_data<span class="sc">$</span>NB_VALD</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the column</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>sorted_column <span class="ot">&lt;-</span> <span class="fu">sort</span>(nb)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the 90th percentile</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>percentile_90 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sorted_column, <span class="fl">0.90</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"90th Percentile:"</span>, percentile_90))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "90th Percentile: 1782"</code></pre>
</div>
</div>
<ul>
<li><p>After displaying the boxplot of the NB_VALD (number of validations) we see that the vast majority of the numbers are low and after displaying the 90th percentile we can conclude that the 90% of the values are below 1739.</p></li>
<li><p>Some values are too high but aren’t considered as outliers because they represent very popular zones like “LA DEFENSE” “CHATELET” and the maximum number is around 120000 which is high but still a real number.</p></li>
<li><p><strong>Collecting geographical data</strong></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the new dataset</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the new dataset from Excel</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./data/zones-d-arrets.xlsx"</span>)  <span class="co"># Replace with the actual path</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  ZdAId ZdAVersion ZdACreated ZdAChanged ZdAName ZdAXEpsg2154 ZdAYEpsg2154 ZdCId
  &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;
1 4638… 1034907-7… 2019-02-2… 2023-08-2… Chardo…       646159      6860774 71141
2 4884… 1493256-1… 2023-08-2… 2023-08-2… Républ…       649846      6857324 70508
3 4884… 1493241-1… 2023-08-2… 2023-08-2… Républ…       649672      6856977 70449
4 50418 1328878-1… 2014-12-2… 2023-08-2… Verdie…       649922      6857478 70531
5 45051 45051-707… 2014-12-2… 2023-08-2… Villep…       637365      6860418 70717
6 59029 1186006-1… 2014-12-2… 2023-08-2… Rue de…       635174      6859926 4272…
# ℹ 3 more variables: ZdAType &lt;chr&gt;, ZdAPostalRegion &lt;chr&gt;, ZdATown &lt;chr&gt;</code></pre>
</div>
</div>
<ul>
<li>Merging the data after grouping by ‘ID_REFA_LDA’, ‘JOUR’ and ‘LIBELLE_ARRET’</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the required columns</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>selected_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ZdAYEpsg2154"</span>, <span class="st">"ZdAXEpsg2154"</span>, <span class="st">"ZdCId"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> new_data[, selected_cols, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming merged_data contains your original dataset</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Group merged_data by "ID_REFA_LDA" and "JOUR" and then sum NB_VALD</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID_REFA_LDA, JOUR, LIBELLE_ARRET) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Sum_NB_VALD =</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(NB_VALD), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID_REFA_LDA"</span> <span class="ot">=</span> <span class="st">"ZdCId"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., new_data, by = c(ID_REFA_LDA = "ZdCId")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 113 of `x` matches multiple rows in `y`.
ℹ Row 3540 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting dataset</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   ID_REFA_LDA, JOUR [3]
  ID_REFA_LDA JOUR       LIBELLE_ARRET    Sum_NB_VALD ZdAYEpsg2154 ZdAXEpsg2154
  &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;                  &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 0           01/06/2022 "AIME CESAIRE  "        2423           NA           NA
2 0           01/06/2022 "MAIRIE AUBERV."        5616           NA           NA
3 0           02/05/2022 "AIME CESAIRE  "           5           NA           NA
4 0           02/05/2022 "MAIRIE AUBERV."           5           NA           NA
5 0           02/06/2022 "AIME CESAIRE  "        2302           NA           NA
6 0           02/06/2022 "MAIRIE AUBERV."        5750           NA           NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of NA values for each column</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>na_counts <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(final_data))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(na_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID_REFA_LDA          JOUR LIBELLE_ARRET   Sum_NB_VALD  ZdAYEpsg2154 
            0             0             0             0         11396 
 ZdAXEpsg2154 
        11396 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delete them</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(final_data)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of NA values for each column</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>na_counts <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(final_data))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(na_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID_REFA_LDA          JOUR LIBELLE_ARRET   Sum_NB_VALD  ZdAYEpsg2154 
            0             0             0             0             0 
 ZdAXEpsg2154 
            0 </code></pre>
</div>
</div>
<ul>
<li>We checked that our data is finally clean.</li>
</ul>
</section>
<section id="exploratory-data-analysis-eda" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-eda"><strong>2. Exploratory Data Analysis (EDA)</strong></h3>
<ul>
<li>Converting the date column from string to date. We found that for 2023 there is a different format unlike the other years.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>JOUR <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">substr</span>(final_data<span class="sc">$</span>JOUR, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">==</span> <span class="st">"2023"</span>, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">as.Date</span>(final_data<span class="sc">$</span>JOUR, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>), </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">as.Date</span>(final_data<span class="sc">$</span>JOUR, <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>JOUR <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.numeric</span>(final_data<span class="sc">$</span>JOUR), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Summary statistics</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> ID_REFA_LDA             JOUR            LIBELLE_ARRET       Sum_NB_VALD    
 Length:4274003     Min.   :2017-01-01   Length:4274003     Min.   :     0  
 Class :character   1st Qu.:2018-08-19   Class :character   1st Qu.:   819  
 Mode  :character   Median :2020-04-12   Mode  :character   Median :  3746  
                    Mean   :2020-04-08                      Mean   :  7536  
                    3rd Qu.:2021-12-01                      3rd Qu.:  8791  
                    Max.   :2023-06-30                      Max.   :255072  
  ZdAYEpsg2154      ZdAXEpsg2154   
 Min.   :6786790   Min.   :593192  
 1st Qu.:6857458   1st Qu.:646374  
 Median :6862185   Median :651088  
 Mean   :6860202   Mean   :651310  
 3rd Qu.:6866269   3rd Qu.:655857  
 Max.   :6896437   Max.   :722333  </code></pre>
</div>
</div>
<ul>
<li>Plot daily ridership trends (we summed the number of validations for each day)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(final_data, <span class="fu">aes</span>(<span class="at">x =</span> JOUR, <span class="at">y =</span> Sum_NB_VALD)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Ridership Trends"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sum_NB_VALD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data based on IDs</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>filtered_new_data <span class="ot">&lt;-</span> new_data <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ZdCId <span class="sc">%in%</span> final_data<span class="sc">$</span>ID_REFA_LDA)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to spatial object</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>final_data_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(filtered_new_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"ZdAXEpsg2154"</span>, <span class="st">"ZdAYEpsg2154"</span>), <span class="at">crs =</span> <span class="dv">2154</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to EPSG 4326</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>final_data_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(final_data_sf, <span class="dv">4326</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>filtered_new_data<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(final_data_sf)[, <span class="st">"X"</span>]</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>filtered_new_data<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(final_data_sf)[, <span class="st">"Y"</span>]</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create leaflet map</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>my_map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(final_data_sf<span class="sc">$</span>geometry)[, <span class="st">"X"</span>]),</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(final_data_sf<span class="sc">$</span>geometry)[, <span class="st">"Y"</span>]),</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">zoom =</span> <span class="dv">11</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> filtered_new_data,</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>X,  <span class="co"># Use the X column for longitude</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="sc">~</span>Y   <span class="co"># Use the Y column for latitude</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the map</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>my_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-8336dfa711916213a891" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8336dfa711916213a891">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[48.84476121325202,49.03238457931415,48.82371207781244,48.92950055175439,48.84892531548521,48.84399743320565,48.90597351228895,48.87564471607175,48.86217829210464,48.87569757847002,48.86998982041234,48.86343076279542,48.83960824473966,48.86283559775448,48.86286466035352,48.26863289158201,48.83707778702632,48.18207091880802,48.98576613136753,48.60718067638641,48.57701492114761,48.89707892967396,48.5649239702118,48.99387223998639,48.78654552609,48.54049530079394,48.98513096906862,49.00870608896208,48.79657675296793,48.73218515134968,48.69971662200307,48.26737393534187,48.9439683200106,48.86788178540942,48.89137855853846,48.79894713436509,48.9188444274846,48.68176608717147,48.83948256463047,48.85289754437599,48.8630606742116,48.87150379720944,48.83850345362355,48.3866749769233,48.7396532024416,48.84163094770569,48.95462325635096,48.84479778441793,48.97292115113301,48.87197833934214,48.72494435811685,49.15474844555425,48.81365808740043,48.97029330108813,48.86621229484555,48.87115745782025,48.83135525881832,48.70297505228798,48.78783124289829,48.83150636880364,48.85959666217409,48.58629250914198,49.04712582400307,48.65906727454411,48.65314591091681,48.84666794059893,48.8223650740583,48.98032256016813,48.87995212156086,48.87639452146733,48.78774602283841,49.09789952411488,49.11689719438235,49.14775003621167,49.06623827397407,48.83938659296782,48.78819579706985,48.83375466631816,48.67657931900258,48.70088013521177,48.8114964851139,48.98269923483507,49.00557626085363,48.82980548777184,48.63364995024487,48.52807732997363,48.64868780403037,48.84428256127604,48.89302918798336,49.05613929537505,49.06308499678575,48.89480249770918,48.90841031984958,48.85662051006724,48.82511076297198,48.84292180866699,48.90683184118247,48.87973207308006,48.87526709886689,48.85455208743772,48.87643983285375,48.90715888834416,48.87836539418379,48.8760733153801,48.88557568111788,48.85215647037462,48.9003780087206,48.91526089690082,48.87842734998551,48.85289341586265,48.85162026044091,48.82151393205603,48.87284204741142,48.83920081428043,48.79434473993987,48.8435916890918,48.80653436924725,48.88723934641234,48.91184008505535,48.9946086118595,48.97384772472763,48.84074897820344,48.82487632379503,48.88732067095575,48.83099470535117,48.87888225226061,48.88793547724306,48.83092943968435,48.89139444991616,48.98085618475226,48.79668309076131,48.815454988516,48.62492646587375,48.89099447657826,48.99078770690397,49.00683390344956,48.59612906940653,48.52941998657892,48.55581803737436,48.56114987738336,48.51321019790095,48.80779779330969,48.4064198532358,48.8945044958291,48.89016977995573,48.88357713199415,48.89401529863282,48.82634152333723,48.84600372692167,48.86416488888286,48.82464750836196,48.85902280756356,48.8064452097071,48.87812929093112,49.02341075826703,48.88519701049977,48.8851738323981,48.85039355956165,48.86882428025368,48.87721629023955,48.79661095553917,48.87712587313206,48.8844624332184,48.88302013672322,48.89754912996262,48.89463508384691,48.86339304113963,48.84715456697167,48.82183372019261,48.89302855477912,48.82971226159289,48.93571015599268,48.80575729887575,48.88969044100326,48.85828693725399,48.87435320600547,48.6763901915071,48.88212430758915,48.86974283466717,48.87061518637088,48.82218436069625,48.82398803539178,48.83826606364013,48.86081393594011,48.75463205717313,48.75447836844632,48.89782939037996,48.92992275044575,48.83665029922329,48.83240821453493,48.86752501783031,48.84700773108863,48.82763555587722,48.83352075965512,48.82141651539811,48.81073302257494,48.7813006333505,48.88766793348668,48.84542285119878,48.69750766118558,48.85251913911763,48.89794951079969,48.70130664017173,48.84378428860465,48.79332991028714,48.6962061326892,48.73984159128457,48.8427109910511,48.84402783601856,48.81585477121313,48.83287980739804,48.86407705241764,48.86641283715331,48.8535185360263,48.84544212065089,48.83495408901352,48.88370306842295,48.85854101968594,48.85228685193148,48.82136382099295,48.89467266005628,48.88376635447715,48.87524734864142,48.87948099577309,48.87090205078727,48.86581787079567,48.85622642746082,48.8617404982966,48.88056877012684,48.82425435678085,48.87599903205398,48.82986001331236,48.84093517394162,48.89753942314597,48.90347160190108,48.84684716414615,48.90670909310837,48.87603510668865,48.84647863148516,48.86398776221351,48.88548947342206,48.85244324526238,48.88194921492064,48.8842525693445,48.87844152839057,48.88703292802266,48.86495760589309,48.89063914901309,48.8930014419616,48.8749943468783,48.87532881892318,48.87360588811276,48.70645069789057,48.8002810185318,48.82324782508941,49.11662704127191,49.00734770817908,48.96016573664726,49.00812817296871,48.87168947767002,48.82121358221712,48.94699551733695,48.99620191069558,49.03411802868779,49.04530683634749,48.42748655748515,48.96365167276247,48.79877005538498,48.8460533169787,48.65905689247081,48.79653636052196,49.06087433009002,48.83083441158298,48.67655256408834,48.97356363050665,48.74163196270909,48.63633518906385,48.33649453149206,48.80266227462239,48.37959487748362,48.81435959975815,48.51378615552292,48.70228887084095,48.51028716959448,48.82310598750408,48.74519291827379,48.93172049557505,48.69335656301286,48.56619369553042,48.62330634408587,48.52062055349796,48.59111916474818,48.97988373233732,48.76475552407521,48.81933737870203,48.74645526039487,48.48734824062989,48.41666609892101,48.63438982716064,48.49387742150091,48.58271578166406,48.53541229412233,48.97592120715231,49.03214919826368,48.85955477757579,48.89861557102041,48.99691492850533,48.81422133231393,48.76387974410588,48.70087106218507,49.06912777550041,48.97969038345532,48.51404864709705,49.03630213519236,49.1551161358941,48.56432958931043,48.5328988647378,49.04510356746614,48.91419560591249,49.09838299578009,48.58599680193004,48.83685993004764,48.85135454462724,48.84993188825682,48.84794743340012,48.84931726865667,48.84438184471572,48.86282891993346,48.86649020888934,48.82146094562246,48.85595605374676,49.08102712049871,48.82590691849223,48.89646355558128,48.85715990843854,48.88237797796589,48.83946536902408,48.86518281440146,48.87500344147832,48.88352423658399,48.85082534460907,48.86400481420817,48.87258751184467,48.87879121854144,48.85321610433085,48.92372579009854,48.85437512138642,48.52850628755528,48.86867762293442,48.93039044134454,48.87997292379213,48.80492824651398,48.89389539889133,48.89783965415329,48.863773833022,48.8480398970078,48.86872741554144,48.85208303076493,48.8513415872505,48.87869453906465,48.86962681004209,48.87188544556199,48.80100520605725,48.85298808409852,48.51398126165003,49.11204487383715,48.93391909503801,48.91662348865884,48.31172389397199,49.10101988153189,48.53555334351643,48.68492579663928,48.96083066023569,48.81868446694094,48.74000663544405,48.86125145498573,48.87834330771727,48.88308122211457,48.81439200871277,48.90549075605567,48.80754781837646,48.90112970125558,48.86249378865904,48.98439355919069,48.89669234117503,48.88986185089914,48.95065288242802,48.94574060746957,48.80979002109876,48.8462945777086,48.7300757707461,49.09951161811565,48.87322862921089,48.93080118633741,48.97715273204428,48.84647594930451,48.92081594366834,48.94689075183818,48.88280662749872,48.92448404237368,48.77301460833451,48.85272221586906,48.88079715848241,48.88307794126765,48.89838722477501,48.88443144713286,48.741702846557,48.8319893559141,48.85014581479666,48.89140685494191,48.80316018957517,48.81026192931137,48.85769581552947,48.84918227714,48.85015560027126,48.88229807435636,48.81636869284266,48.87417270977652,48.86270845652009,48.92980264562672,48.8768999814237,48.83503951179316,48.83970564113083,48.77205915765386,48.80681514122091,48.89873714815461,48.87234698783902,48.8343053755762,48.69816638928211,48.81522805507854,48.8542384576397,48.7986887306105,48.6952977168668,48.84513499388826,48.90455761820595,48.88810285780774,48.94586657033911,48.851278366135,48.87551045266743,48.87063919857904,48.87926525411311,48.84501107466339,48.87458258385723,48.8908500011999,48.89319981106834,48.85205269126925,48.85163021489501,48.86997183478234,48.88078973425426,48.83702939448985,48.84670003526311,48.86229153269281,48.82611193740463,48.84505364937849,48.88362055043074,48.8796250943141,48.87009342545004,48.85570971473621,48.86451396328138,48.85176243983227,48.86965909738425,48.86734660429376,48.86925693431976,48.88739684140158,48.89749776091427,48.83712598065919,48.84879973838756,48.43046104852704,48.51507440066126,48.67590783936994,48.8236671955545,48.80948611179061,48.77478116961948,49.02497224021478,48.93639856696372,48.53568307445009,49.03908912190941,48.38264263708523,48.55093324785734,48.7402155466555,48.87007065119525,48.89645374546333,48.88337213249794,49.04672888045281,48.53508152700067,48.74834176178746,48.83192159292727,48.96276754809345,48.89666340692379,49.06615306939867,49.00774408588278,48.97574793043533,49.05827306890637,48.5705439795364,48.52749127724829,48.90932803605893,48.73481363320118,49.11454057385045,48.62833155122789,48.92068614029698,48.78248922625493,48.53874673073894,48.8771566489206,48.96627788218917,48.97930685000472,48.79601836707488,48.99013609272887,48.37427743758644,48.81076714114426,48.98435914063016,48.62603010015844,48.81046368627958,49.01789595527661,48.61323411528147,48.99115623457096,48.99132517248412,48.66781972180002,48.74793654258728,48.54520687932087,49.13608958028971,48.56485864286559,48.69891444722006,48.43442538962993,48.86985055746672,48.71266379070929,48.88036817768263,48.85121596233889,48.84977918138186,48.86639466127419,48.86422169510521,48.85809940122741,48.86042568906485,48.80879443754016,49.07482977466489,48.8695816731202,48.84065894794337,48.95501890749595,48.98056126041366,48.93345291732809,48.85716226037089,48.89120308813789,48.84527909096491,48.84559514016272,48.827084997527,48.97927725724667,48.8429141645917,48.87394846556919,48.84649951853062,48.82085793402058,48.97515176597256,48.92180925246161,48.79524583076444,48.9022099624714,48.86291855682804,48.90329452009652,48.84381793049817,48.82206909195274,48.83514522780948,48.87423484738714,48.87283664635925,48.83500912698128,48.89113807598267,48.88499490550534,48.83044954004728,48.83908337025013,48.87100608368188,48.86172996394729,48.85822765686937,48.85279983798485,48.8913218127965,48.8621785007881,48.80112202273722,48.85429773930706,48.86797587347444,48.87261717350219,48.95053579465007,48.89022792502367,49.00732541881231,48.86914501847035,48.82711610624524,48.83122005715735,48.74329329348146,48.77006313414083,48.82749983122579,48.90350189702256,48.84709558045338,48.84508526206525,48.97378645494568,48.87109740298222,48.9630311570555,48.60658629410889,48.55149801132313,48.48739999670831,48.59602966921927,48.58538532272398,49.01551294375892,48.73538263733581,48.7718658661115,48.333010232655,48.23052063512006,48.80660251411627,48.83724047550984,48.87229333907889,48.91396008912828,48.84339758443425,48.90421645425439,48.8597668651059,48.84106872031547,48.8609680736927,48.8695046171235,48.83556918256957,48.87784756974145,48.86709174459043,48.88277358523059,48.85381441282843,48.90360844760719,49.09187842615292,48.94516096563167,48.76997419152914,48.70800591448575,48.73383197825108,48.94564757022319,48.95050771153574,48.82604524623217,49.09179958158251,48.83727523453461,48.89222530531801,48.75786586164261,48.6756854322844,48.8955160870039,48.81419743573103,48.74206982221401,48.81192852485601,48.85927597823245,48.99247164289288,48.87299984556772,48.71760294254834,48.70649307508769,48.43760580018427,48.97461303610911,48.93057438215538,48.75462749410115,48.72316038622697,48.69414041737723,48.82969172007187,48.64325837626383,48.81065266902569,48.98767887439544,48.82331640418133,49.04634117366179,49.0451261283382,48.96985164675169,49.04745933203388,48.63640239948255,48.61397937602795,48.83493433564623,48.98075907572836,48.80847908882961,48.81198857378219,49.07931253808023,49.03610532134492,49.07071846647489,48.8979866483138,48.83617383673677,48.84586006713464,48.85367269165874,48.8435603903221,48.89772215420754,48.81895137508779,48.74394344932612,48.84150614724258,48.68617887111782,48.70236853080704,48.72437716777878,48.60539997940678,48.95894184488031,48.83184430042438,49.04649996882236,49.03940571079428,49.04027654549783,48.81054701094502,48.89823927537944,48.89782242560774,48.74709774023238,48.91373037437913,48.90305415107402,48.88787816302306,48.87431279188535,48.85829521013207,48.85330913419949,48.87248415518236,48.90047424103393,48.88248206209167,48.87148665684214,48.88189594945999,48.87948329166414,48.87468978445968,48.71276587238191,48.86456931588285,48.91346155160972,48.8646895331952,48.85201956569377,48.8718428974349,48.83536596939744,48.80660350867725,48.97006137707556,48.96347459809316,48.88575508701126,48.88235471800585,48.84983794999388,48.78338097194746,48.96387622148729,48.90974451520819,48.8106484159272,48.88208901250547,48.85744703597763,48.84781068369743,48.84908923190666,48.92276744096434,48.87304973559242,48.76572162797765,48.86355456456968,48.89606170648452,48.79695388183656,48.81281543895849,48.86545537297977,48.95684581098718,48.53101080740617,48.93882157596103,48.8455088789364,48.84351437238558,48.3425844584421,48.76407275864851,48.87653018492898,48.89196670273697,48.87170861611479,48.87824587608863,48.53449844161461,48.8436075995969,48.85833612662318,48.99377204005172,48.83893923027516,48.91402234501214,48.8963938854484,48.9095730221455,48.97632186246444,48.86213131187652,48.8828684194548,48.91935468389268,48.84750255517248,48.89107874997465,48.85310430783278,48.84088525041221,48.84645459335372,48.88230739886287,48.88426719468971,48.90629953900684,48.78728959171423,48.8974550567622,48.83554698185418,48.78754580444347,48.86582347980312,48.85986830267412,48.85488392607957,48.83841119933774,48.85302375643828,48.79563248966546,48.83173300205129,48.82314686394041,48.82339867212097,48.87856717941639,48.82150332672172,48.92030820630249,48.86675662943444,48.85484314704975,48.70273264602904,48.79532304015753,48.80540169915318,48.71686002184462,48.72551457744581,48.82119386892411,48.83050960378989,48.86979057019752,48.80835621686629,48.74304517277355,48.82817431479741,48.93677436491746,48.8614439217946,48.8796987526627,48.85799258515802,48.87566737659971,48.85849215258074,48.88286856884392,48.89058887012088,48.88438364997454,48.82682329515912,48.85809196689863,48.87960201842079,48.888511618145,48.86524333174285,48.87155915765455,48.86545307716206,48.84714336145718,48.86328817608026,48.8554048866532,48.84024386534577,48.83585990350108,48.86250897184536,48.8627432647449,48.85662459271614,48.84782188825464,48.86894954985684,48.83954947354111,48.88834081597984,48.87203776458909,48.87490559986042,48.80435354249796,48.84267493592615,48.83411292663422,48.83898699685513,48.88214062881733,48.83174129185009,48.89249226820193,48.86472429256455,48.77975652677895,48.82703379825273,48.84622928118559,48.8312276145242,48.89561093631083,48.88118977611479,48.91636560369835,48.91976381223345,48.84507282097032,48.86119015695036,48.80066544772694,48.86354548261792,48.95316210684004,48.70808932141768,48.64438939355557,48.81828495902109,48.98141399529343,48.73944513134283,48.18117262779692,49.11912568345627,48.595487311391,48.93769074963033,49.1233372934575,48.52914889642484,48.88257846329409,48.64384151574153,48.55553094101391,48.86246635084242,48.88839532721545,48.77123310093248,48.77076571895002,48.82662291018976,49.01373817084579,48.97399460214155,48.8603595833657,48.81370021201992,48.70871081599767,48.9566203252873,48.98685791631112,48.98928808940955,48.88080689899808,49.02172297953169,48.86818217536456,48.72168876059148,48.9926668977682,48.82486245454237,48.57358628638222,48.93230245614232,48.91807667562101,48.48549337616188,48.92429737042087,48.74084436425854,48.44272124429534,48.65483745357244,48.93281967344668,48.98300387276142,48.8072689478071,48.43705526347524,48.60581694047945,48.9804943688634,48.95382144743395,48.93273252291907,48.88270544560329,48.79967666787564,48.48701254662157,49.0496421118596,48.37149309709569,48.57760529691963,48.60664456881397,48.85379109028952,49.07571755164643,48.52985734002498,49.0352710258145,48.81887298138508,48.95541087781952,48.82104425462742,48.83176114217657,48.83291826323064,48.82983827591053,48.87340335795378,48.87368738488007,48.84101338002151,48.83675419193474,48.56521162000546,48.93192522398969,48.84208854701274,48.89593111422927,48.86309128324471,48.86224280267729,48.89568578808986,48.85353662695762,48.93804999714734,48.85445986258192,48.86988265346705,48.88580042275268,48.84483077512915,48.89608158414681,48.86384219501565,48.91608476418325,48.92650570780329,48.89675228748666,48.91482210682149,48.88419635691514,48.84958267994801,48.8280688709846,48.85827503127501,48.89946696373789,48.87246664361252,48.86141832879269,48.86740427428237,48.85488820681289,48.88903923574009,48.85485931523967,49.00997206013273,49.00521649563479,48.93042062044628,48.92224567900949,48.9916701443914,48.85645253363109,49.02119301010496,48.84307960572345,48.80589797070364,48.83842211222962,48.83203882681639,48.86110637413044,48.85827207381008,48.88498472738608,48.91960807403226,48.81531932357728,48.88988347615403,48.88187430754663,48.88839712956314,48.77125404013842,48.65405478626803,48.87097240022151,48.41662871074266,49.11264118094719,48.48698928268781,48.44330422708984,48.51043223504175,48.58259677337617,48.903303866973,48.5461968446517,48.33656722249728,48.89518231353912,48.90169663309354,48.37908729467771,48.88242244993251,48.87178400726697,48.87048977361882,48.39465050900667,48.83872316050616,48.84146544987845,48.84233950886421,48.85769882970325,48.7951262169964,48.83826194997239,48.8288801225864,48.87661736719483,48.85212954281064,48.8299615538608,48.80806884526892,48.74815082901701,48.75175107059861,48.76459473530279,48.86869482413151,48.74834727001421,48.77044496836015,48.82382236612232,48.85840499659427,48.76508218714334,48.77171577094423,48.84707750734599,48.85497118501824,48.96014375053215,48.43745388391451,48.86736553640046,48.87512793970188,49.03202664841572,48.87214567161733,49.03253532609951,48.97579500762209,49.01049691598681,48.97679423363334,48.57154961764436,48.82036850587272,48.8541478215361,48.7967604263323,48.69367655334832,48.80973640852351,48.69318750864959,48.99315351803715,48.93864834537347,48.62401526996526,48.53342397682304,48.8672946808176,49.03547110352708,48.8761174457773,49.03936077664787,48.99747789977918,48.89897375303253,48.85792684583432,48.85261631318608,48.83970455514125,48.98885694266892,48.89148093635936,48.84360910087715,49.04694374406105,48.88097374113426,49.02564946952005,48.795476424479,48.80134527326831,48.84354315751465,48.80395998542564,48.88296107292324,48.83247714298403,48.80750596430107,48.53448013654905,48.79677178003383,48.794454150816,48.84095225071896,48.81861562303352,48.56474089499119,48.53448535295507,48.56640992854983,48.48501858143334,48.94624503796924,48.82699752072009,48.8199908020017,48.89672606839508,48.91503127902214,48.90689128413673,48.87193193030098,48.89660085117295,48.87462879955804,48.84744875725395,48.83874558963302,48.82157240084411,48.94641180519432,48.90406787455296,48.8648599674391,48.89036742331108,48.8649532920161,48.89771480454039,48.80712879614942,48.80449078809097,48.89517661289931,48.82050108030872,48.93398557478508,48.99485861259807,48.90411508710576,48.80787286971756,48.8888886004486,48.88725203387953,48.87976090427039,48.91634994788598,48.81464668209385,48.89350796684161,48.88249148773381,48.87081477705078,48.82492734870883,48.86089631437338,48.81036977611707,48.8646603081886,48.91401210110255,48.89731774727882,48.99347957158329,48.85870238705247,48.85574640041682,48.93628371180323,48.7253189473246,48.88773841779183,49.00492867158547,48.75310251661842,48.86972362107785,48.80617880906832,48.80522945428866,48.99374635691404,48.38028782904419,48.73866335820809,48.83715458794274,48.7469230839381,48.67705897397836,48.99084508182347,48.93526165671091,48.95362907356586,48.83933891552114,48.83865918848552,48.83804573402018,48.69429292502762,48.79898482534455,48.64230823878482,48.72142997566064,48.8267071936747,48.91000110969775,48.93332879454723,48.97182264466839,49.04987466633607,49.03357855785399,48.58624085643101,48.62540190584095,48.93956875223088,48.88134850883171,48.69965685948944,48.74546144318292,48.88501928011794,49.04942977682503,49.02410494732536,48.84265525074534,49.02306152447348,49.05753064443212,49.11477216930366,49.07789520680488,48.84821291717003,48.84728354446145,48.87632889449834,48.81542996173005,48.77953526838593,48.9627005039902,48.7412424657637,48.52921287498318,48.66934301347034,48.79037465821809,48.78985106892193,48.81423639270866,48.87691369965446,48.87772941930381,48.76875230962659,48.82989319999329,48.91305793223299,48.89372793126256,48.89486701884441,48.8481109335596,48.82878653587922,48.84302572740644,48.86587938204958,48.96723437485978,48.88377864200487,48.79905791695275,48.79627756900349,48.77102824359029,48.76230621767594,48.85327228892326,48.85332118021466,48.93756975403343,48.82374677626137,48.84436748819835,48.82254366912613,48.93336173220935,48.89543446074372,48.88915337108452,48.89190816251696,48.85490025567049,48.88133804019958,48.88444007559659,48.37024633464598,48.81467253387452,48.67058370435482,48.62805807247668,49.04514621020982,48.86337990238327,48.87056163884072,48.81145989435268,48.80877205816934,48.93247809855512,49.0065297734197,48.98883604124404,48.89593449222931,48.84823134435846,48.85266834015275,48.85855663056117,48.8878354456813,48.85214171356726,48.80643306829938,48.95511043295902,49.01925258768035,48.89698500553894,48.880051080305,48.83543149020836,48.88411394160433,48.8908412923554,48.83931921031588,48.84161680081523,48.8400794698319,48.72597177635296,48.87424921820553,48.89527537670353,48.8938152613519,48.83646213042192,48.8550972311597,48.84457006169939,48.73043805178512,48.5648274963714,48.99393154090473,48.56508974780397,48.98949075906079,48.37772873511953,48.70294383384226,48.69943144725116,48.76868654533914,48.95653871409946,48.89491222539031,48.8154379470675,48.90319988682607,48.79904997883504,48.9596488601079,48.81961911422354,48.890444485507,48.84461135150372,48.84438047888516,48.87056238091382,48.8798872820617,48.77470594249531,48.91769737260247,48.99821308625921,48.86609287916148,48.86460627414375,48.74171073085871,48.99218881234461,48.92313864517075,48.9330212718114,48.87492263360983,48.95519595994167,48.78155686904705,48.82990200885752,48.69790989199161,48.86084189927694,48.90377022040018,48.71664470535532,48.85253997879608,48.8535936478366,48.39269200651419,48.5333449697845,48.84321371719648,49.1176072466841,48.56171662606747,48.67061983320635,48.66999197610071,48.67538864799303,48.67580107151593,48.94740580438286,48.83349605233864,48.83053398223794,48.79838256587888,48.85135802912354,48.51290104587399,48.84240954252611,48.89839402564201,48.78798389874359,48.69925295807337,49.03871315910069,48.8782097455064,48.34757860925878,48.52068224259166,48.84005686894317,48.96863904590406,48.98279716862928,48.81263067384786,48.84240763929051,48.77234150768057,49.04933274419437,48.78883131123265,48.85121996286068,48.81115050891491,48.81556216066888,48.89510003597162,48.43044412450797,48.81846313939264,48.90284972683092,48.78992474211481,48.89740198480391,48.88379775469796,48.90637223976029,48.83307618955925,48.89766336924617,48.82740979814309,48.81901965389277,48.82035084392618,48.93018592182085,48.90651367872775,48.86391277608902,48.87193757742747,48.85798570798345,48.84325137440358,48.82217191518451,48.85126525456177,48.92080507340246,48.88403928230525,48.86370301202431,48.89555794423479,48.84822865982206,49.14757843554273,48.83774228882642,48.83714072048612,48.84167068761248,48.84843508629857,48.93056718345499,48.86443608260307,48.78023978699613,48.70590791056931,48.70549707408607,48.89588533319012,48.89501778662688,48.78756698215642,48.83671334959764,48.75225960739537,48.769714103197,48.83853531420648,48.8526860555495,48.8801595806643,48.84561150636878,48.86109023471275,48.84431751431355,48.8668483434173,48.8311340385114,48.83797554529627,48.85492515355667,48.85621735902721,48.84801195373871,48.81121009339331,48.84013906626924,48.87798190152846,48.82614504964258,48.87711995973975,48.83911208062214,48.85358500993072,48.92306946822528,48.84719002378814,48.82215880981159,48.87186101875512,48.88379672531627,48.8687567976557,48.88279934330809,48.86468319866766,48.85390250581764,48.83319944514154,48.88516061413552,48.8684381810926,48.84297940238287,48.8482614978633,48.83370053612187,48.80546799896962,48.9625586826304,48.93982394136496,49.07926306654275,48.59281066721324,48.94408697974944,48.38667409747334,48.8366799938234,49.02171832893956,48.87516854083153,49.00667304663374,48.39428183617056,48.82725236463642,48.97087492360019,48.7874766754562,49.01523039241486,48.99751289061128,49.11366936222741,48.89425799799316,48.83887742994718,48.93324528898979,49.06281443608871,48.83998667910805,48.58688196860367,48.61408914934274,48.37789339275472,49.08081186199352,49.00580793707505,48.56563999757163,48.89302020567544,48.39366679714891,48.83925301967572,48.88219040124504,48.7551670555858,48.89310225399451,48.95077734231208,48.99224042170688,48.8139591342409,48.99607353828386,49.04527266532599,48.80852747756023,48.99052888151807,48.97287556014462,49.0231984966435,48.80805936234078,48.92395840814695,48.7437479319557,49.16299690634341,48.97035252474219,48.94344832670416,48.68086919857236,48.33245101590995,49.03882186493522,48.3412085971076,48.7508679408046,48.22938909110704,49.0703449831661,48.93214643953129,49.00979392329096,48.97064043542484,48.92324251610346,48.84570337708193,48.86245912099595,48.86493906965636,48.87403314443548,48.87326363211805,48.85613709361674,48.86843314869182,48.86206394896858,48.84445563703013,48.88432877901106,48.86986080619505,48.74713998137218,48.87474229926693,48.80561113765102,48.86255658748993,48.76417747193756,48.87972038504819,48.990348238689,48.89738985745587,48.8628167602688,48.86624031959919,48.88604118891234,48.87583768750856,48.85380692347806,48.95473102343872,48.8925672556546,48.90724129485055,48.94377613247828,48.93193509759839,48.81308309755897,48.91968355363869,48.83770589012251,48.89785657094917,48.87576224797295,48.88460816521672,48.87501561528555,48.864482394729,48.86671740028095,48.85634804472546,48.86663808812246,48.82249126549176,48.87280028477049,48.87351861704153,48.86792858271328,48.8540611181395,48.84836312682409,48.84621330528737,49.06063446276719,48.74079709850226,48.83858170539126,49.00414552342265,48.92147388394663,48.98982979293228,48.83874265474831,48.70040483577974,48.75575438258549,48.64351275399223,48.8416317788578,48.79566567917144,49.0346619000496,49.13600366464749,49.01484737646322,49.01795280197482,49.05853565472179,48.62356475759536,48.61374411834075,48.70023302763921,48.60625238659596,48.97063126391741,48.93323413890162,48.84404226338373,49.13258174077438,48.84328883582449,48.79950674682767,48.83606534350138,48.69750076633709,48.83271341005773,48.82949347490725,48.90912552819175,48.992037905378,48.84514957420961,48.53208079399571,48.59308650578351,48.81876704201716,48.83770220051944,48.91425382266375,48.99635720614124,48.86179367574162,48.95803272703169,48.89532601530018,48.8097460653206,48.80354814485138,48.92293932890927,48.85170445819229,48.82347780577992,48.83002727439819,48.82991659975906,48.87451251869276,48.8670864851382,48.78995527685628,48.87660131611196,48.88469469943406,48.93152966448839,48.81040337631367,48.87228200728569,48.86552890127446,48.84037181806745,48.89253017961571,48.87188851439439,48.8739572401249,48.87410822614816,48.87542532522456,48.77984672031571,48.84430041349368,48.87575722370669,48.91854467103256,48.96025072774263,48.93473009572329,48.87722808680414,48.88325121381506,48.86189393415183,48.90821906814642,48.93129378965423,48.88538270187248,48.89122722404846,48.86981756907122,48.92088660937341,48.70844016974556,48.9324722904296,48.97592200201693,48.96816633782701,48.97495015481181,48.87246658018499,48.86710086839634,48.75487584161579,48.8067945285765,48.79964744893528,48.8314080833488,48.86655464325077,48.85569061132114,48.43513522870105,48.95845634041321,48.73949577760241,49.00677616837842,48.88283099847463,48.87918368521584,48.80096124961563,48.883018794733,48.8602731810632,48.83318190227116,48.98164579709346,48.76171200524062,48.81904584338533,48.83575580376689,48.84058058485022,48.93482889939617,48.80217813521484,49.03307204384691,48.8564765666592,48.89013309471286,48.92057345133611,48.88230486057717,48.80619646498219,48.82637868330981,48.85752326901492,48.89560865249263,48.87669402538216,48.83228052741376,48.83610874663029,48.8980272598578,48.87628693792178,48.84721842812635,48.81530189685698,48.88956420480944,48.84771390789891,48.89396583504163,48.89284856798621,48.85591396926009,48.84734152927616,48.84188367227092,48.83757904236313,48.83256772870941,48.90636616151026,48.89190891954084,48.87621621981057,48.95899660841441,48.95792884911306,48.8944595365128,48.81907040485323,48.82008719553984,48.84734680229062,48.88293865591474,48.70814555564328,48.84289219066991,48.84350958831243,48.73498922674182,48.78025987210349,48.90518724635219,48.87381342542993,48.86473064237022,48.88569202941774,48.88229195553598,48.83703673061022,48.87683109148422,48.84699312132632,48.79630858101049,48.88849051265777,48.85813001779282,48.87838024680536,48.83333236036838,48.87845426548309,48.84142733223358,48.89221504010709,48.86526252739102,48.91183169975212,48.85747653428459,48.84201842405643,48.80894565167572,48.85708767726936,48.91472994908608,48.85123510948608,48.88812599457776,48.84751597461639,48.88716040411004,48.86989029854755,48.83411441909913,48.86635324461676,48.84508829917885,48.84067248206251,48.87360326668289,48.82967818374509,48.85523260459462,48.88129083793358,48.8713909759139,48.8787623883211,48.84612558033093,48.8147947888117,48.86757363913574,48.8318752174203,48.88106392041809,48.89138804134525,48.84214271190284,48.85361960424617,48.85117357058616,48.89720541673816,48.87766808080003,48.88235501489215,48.85587560880108,48.8512484835374,48.84716158046345,48.84612723094583,48.84259784059749,48.73968682540993,48.74461107569189,48.79991240057736,48.79525196984341,48.75896752134035,49.09092958106338,49.09954780285818,48.82931238200398,48.63561098843813,48.56502089598088,48.65295347339147,49.0191727919544,48.89798741819351,49.13282782122972,48.78958714978987,48.89106681748542,48.80595748166784,48.34855036640624,49.07775307183675,48.87152491574418,48.98360885402226,49.11709473178811,48.98420199876826,48.91364819871563,48.99258364891609,48.85624510144093,48.88884567970053,48.93074434035057,48.37862829627916,48.84262068421886,48.99837487688993,48.9203475327126,48.68617887111782,48.64880840591744,48.84031288133051,48.83824994444765,48.88372420816589,48.62588382477458,48.90289508215707,48.96339975286425,49.05504799021741,48.80587734066903,48.53375600022184,49.03283685798492,49.09188974448782,48.8974966308523,48.87411946524606,48.80518593344835,48.81299614830529,48.95916631474559,48.40726497812816,48.98514912178446,49.04823256778275,48.85698107128231,48.47579377527031,48.86005654863715,48.85352098773157,48.97233218854756,48.90587474197106,48.31160112213947,48.85786651451041,48.8816114963451,48.85443017232266,48.84659247964589,48.85098548649883,48.86224369307244,48.87110218855138,48.85822150246834,48.87623431549027,48.94319807415802,48.84695088227624,48.85771386937968,48.85259130032343,48.91774737437512,48.88676970102699,48.84365251358692,48.86842864293053,48.76941202049482,48.86398704686882,48.87193292946702,48.83441138481109,48.82400263299876,48.87044250606621,48.87373153846549,48.99613411514152,48.89530916882678,48.89505031902296,48.87156085495945,48.92707020579917,48.92710708081752,48.98012012955919,48.87469562971791,48.87797627140908,48.93082494874623,48.90266349025463,48.80686745368737,48.90615146537011,48.86563796293547,48.84896085350321,48.88467621783968,48.82881108169914,48.84856378250128,48.84089137453301,48.83040351245618,48.83859162835801,48.87920682747145,48.83403157747973,48.38178654572144,49.1625714811782,49.12427731051491,48.80386967662336,48.84141639991859,48.76270291898675,48.98003111137617,48.86115871525493,48.94753490217632,48.87523064854209,48.89438144711944,48.83788762321445,48.79315347198771,48.26783581019792,48.65321986534895,48.99688882704054,48.88255850877562,48.98482228634155,48.99710727421863,48.47487748022946,48.41520820717931,48.66778590618377,48.56529153125408,48.841536799703,48.87492285447231,48.79645115881146,48.77967028293678,48.98536255083064,48.18183497642005,49.09956437510923,48.88104250406463,48.84126158218429,48.881180535581,48.89663207787833,48.72577676679823,48.81404220058353,48.57091089582206,48.84702402431586,48.8427162227223,48.85346892655279,48.87245547031581,48.86084408400615,48.87210674606845,48.78862538612734,49.06986521123704,48.70695496162172,48.73970911261286,48.64482114587568,48.87747085366964,49.0219388267869,48.93265412274542,48.43668748651855,49.0040580457616,48.90254002544072,48.81000299979777,48.89724898551686,48.84500701664281,48.88602247159188,48.88488029323299,48.70640593543061,48.70783120132695,48.74530014874058,48.87440508562041,48.89153144320967,48.90846665791997,48.70588373135889,48.42785451265948,48.49374625316339,48.97612338421576,48.84729024155011,48.83851471348743,48.84599036327911,48.63602252754317,48.79971895066831,48.80256506310371,48.80482780999765,48.80402882071489],[2.266365023153178,2.47677728254465,2.580970832717282,2.356260040163733,2.39676089094382,2.46293086297814,2.366127852778179,2.325948546841061,2.376788362993234,2.327352200402178,2.370914603177788,2.409174370444219,2.396814225494861,2.88315944097373,2.885312995921709,2.685046023898237,2.373437197429809,2.735183666210087,2.35095859177014,2.30133989540318,2.191417386750045,2.329722096702696,2.290003234580257,2.234182096472196,2.045141861937684,2.623780156857771,2.256978129209116,2.681161663759752,2.447831629360098,2.44731582535256,2.507243596202054,2.685309600620126,2.411931969017896,2.051121726865693,2.318802884332843,2.185908127119207,2.361399799381702,2.532528713090741,2.301019417314476,2.335114876076462,2.366704516737972,2.34303004674499,2.360721970016983,2.842804737854411,2.759485889470486,2.308566364736392,2.39182065078618,2.310309393203776,2.306902064937402,2.355880301067222,2.418856826123904,2.326593345636094,2.389079746769854,2.264293023672058,2.352311899624748,2.096707347357697,2.329831559972495,2.070165469577717,2.046207282270275,1.943368915457287,1.875462373121668,2.241036417552258,2.095956996910863,2.41343798896523,2.394918512877009,2.340522409221887,2.325670310225065,2.182712138606878,2.355263534744282,2.355962030042605,2.36651618471325,2.361714169061922,2.368315385411735,2.279426106063489,2.321981047654161,2.361051758155532,2.044553568219896,2.24355073069695,2.33282039854102,2.307004115629188,2.299937440539862,1.715845966387772,1.900392728154024,2.230721165163512,2.451803479564452,2.655154984771448,2.434066257378312,2.44075848621034,2.500367917714422,2.12309580562213,2.057103679867717,2.312074796051269,2.378076599501412,2.351436193669264,2.357167634979638,2.312514345864578,2.366881377011096,2.356152557384455,2.324371862458045,2.385533824471918,2.331419340686455,2.449455301119086,2.381803224075991,2.343190558147165,2.34253886367584,2.339335436997667,2.344084298708104,2.293356666838219,2.274276404069465,2.370943839251656,2.327036117825094,2.369115969872155,2.329734055606152,2.633586649179649,2.513728000580622,2.464706393759062,2.472030930113859,2.171503870111111,2.333556916742705,2.416305724238395,2.513647129487418,2.552058045068681,2.510977874315008,2.313741942949413,2.354207084697788,2.27069762611268,2.3253939551484,2.34386833572848,2.402637973886182,2.005667192948529,2.131324200575455,2.078605670187641,2.425476242152518,2.240032368543126,2.161531080590387,1.918054529180595,2.582249303308829,3.254759697966284,3.302627199099271,3.012494961699442,3.250212880412293,3.082363808793076,2.799236523803708,2.347199846737149,2.827210960777224,2.853604746370839,2.480609281918364,2.200355209741486,2.418828704293575,2.272989268028107,2.274616387103884,2.213606465495407,2.616075249016696,2.371007175829627,2.462565807931259,2.155935518961032,2.155199490635776,2.29365034383956,2.309568670230988,2.280742548875205,2.449396821313306,2.41064153058841,2.379985363459499,2.302548675653719,2.373377789586335,2.314245660927116,2.408820391919217,2.409576927849276,2.370065514502959,2.237452180754068,2.263048600707745,2.347119572641218,2.364132480116449,2.338518252378198,2.346958519105715,2.295329621120029,2.352354236103988,2.310919577422274,2.285262788470948,2.27479424046959,2.323929241904666,2.327992101072778,2.32249444041123,2.314758992786216,2.300890371505836,2.300756402160653,2.385814157962811,2.3561729251016,2.27842762039412,2.287927141756264,2.363991973063865,2.410804996701501,2.30526480055205,2.40242931363797,2.369403170513265,2.301649864161708,2.297920016143956,2.172356228095427,2.339802338959633,2.180802773891949,2.514588821838684,2.122132232303764,2.097713427948084,2.463532595393027,2.322002607270492,2.164341197620089,2.288101389533848,2.2917923550957,2.390454251300179,2.377301142357536,2.337113961821286,2.380473343512278,2.383471833010673,2.410704119548984,2.429204580111946,2.368081391994913,2.327603342025208,2.323089476272675,2.389267389403305,2.413846023866576,2.382291557164633,2.332484375434363,2.389325378910096,2.38889394915601,2.331803982024296,2.334513755718576,2.370263027605763,2.34696975192976,2.309412967374703,2.273559421060718,2.344404956567259,2.350611225926166,2.325321048584333,2.344679304044945,2.305780563117104,2.316373458734527,2.365777834616236,2.337887252682494,2.285622739224663,2.27789902956658,2.258509065182359,2.268069437112898,2.393228471227492,2.367374081559253,2.362031569634715,2.386664276153398,2.39793838796054,2.320040002245321,2.327483258626126,2.32864289348179,2.325748121316791,2.315326927854242,2.4831802104611,2.402687580799876,2.542633291540441,2.368236491954247,1.963016916477464,2.949677642911016,2.680249406830201,2.221049973489006,2.215075666215831,2.524724900091635,2.368675919787719,2.128117701948971,2.105222195898199,2.145255182916241,2.285774636006401,2.072705714296592,2.217631296604852,2.414985969576087,2.152224081216752,2.131239469673476,1.96008472387989,2.332861487131924,2.514551332810604,2.403045616219437,2.407680437902459,2.738333779690505,1.81582545629292,2.942535192460345,2.242878787864823,3.250107308553742,2.294143693758282,2.678938090279448,2.579967802198659,2.417448275110442,2.260948512567054,1.856646491986987,2.492424543058264,2.451993211403836,2.255014220399748,2.266215906699314,2.180341866372171,2.164441106778712,2.257883547622023,2.727167739068261,2.750465255828441,2.726771428722035,2.452297868152848,2.194769238198222,2.223462523854231,1.99600383649433,2.338131267021829,2.699041400454929,2.905437628255216,2.24918299846974,2.098716691509181,2.274243920889909,2.411280736022177,2.306990647160808,2.141077987327266,2.29114186328521,2.215149569550942,2.079774191141002,2.324820246069422,2.170347552441131,2.290071102544621,2.322900028667156,2.271649088824224,2.361324817717878,2.241216969702343,2.402935995573113,2.37590934802813,2.327466749972468,2.328023816552522,2.328523995199102,2.322510319052945,2.353635271486815,2.334123472712849,2.340950196257194,2.274848352781701,2.005047354092415,2.406807265916239,2.222002378077924,2.368207329934688,2.366619599979909,2.395235405414074,2.399803299888795,2.581553468566978,2.332610206460136,2.332838213186649,2.349899350582177,2.330855280269299,2.3225535736417,2.772807822089787,2.259506304578638,2.368813501750655,2.654177016938187,2.362573757185624,2.423290907279975,2.399019257929905,2.363829424085389,2.49675893802039,2.247352752788902,2.370621623176268,2.259873196252277,2.380622522625116,2.267992727304905,2.333485745902661,2.337417118829468,2.338609447592174,2.300857263484049,2.171280657110206,2.41073737514185,2.21720873391149,2.286825532563917,2.535927637460097,2.514877822392908,2.003370605068827,1.970236411992448,2.069747850217415,2.316792742273126,2.948475255915648,2.294134372617435,2.230616061838817,2.122777883156506,2.284217571410367,2.234529647133623,2.2437362795377,2.268783244492472,2.240935174908905,2.213529673845916,2.336764419610442,1.811302075462374,2.298341747951872,2.510831247690114,2.232688511721846,2.144672265933885,2.317458375691461,2.286429238455017,2.446304834407335,2.525517836696695,2.293736053214725,2.260620349697166,2.390655421722269,2.351467057566395,2.3177215733567,2.257906747112218,2.707867840197386,2.385676944545203,2.434827337661614,2.369174230519622,2.373838433204842,2.371451944077974,2.358418006809513,2.360417252706803,2.352781829238746,2.398346402009909,2.34824614740426,2.349775431780008,2.445869420359107,2.362198385305177,2.310520289791532,2.298722548251921,2.384045749653231,2.356693546039047,2.340633228940845,2.295222991147937,2.312648535924569,2.357252641432147,2.406785509714914,2.405804180294307,2.655164426019617,2.507499506271852,2.510534495039869,2.095042054044256,2.329658625359977,2.471681538770093,2.136467373753447,2.340920022007487,2.489046610935822,2.328086584198089,2.151610581640012,2.52566749295752,2.322682065085924,2.315272684401136,2.364508491686045,2.314339268787851,2.39866172336707,2.361077391815657,2.303294362425212,2.261660392649688,2.321013128882672,2.376977079603683,2.413091872131312,2.340086300527676,2.398119628591915,2.370914820390427,2.374138505943128,2.372783819172734,2.351328001673176,2.441628364515685,2.406437158986889,2.401247856173247,2.350118109058783,2.326892412044324,2.325529598830065,2.422959059872421,2.329704892724678,2.401170769368413,2.336318735595488,2.347553815937788,2.380411737634165,2.325564582375937,2.329034701677274,2.296377884655203,2.321280933934934,2.752898337073854,2.599400394746065,2.387021960013403,1.992796424977386,2.136884706853589,2.006586430968069,2.222278554831575,2.535277618418738,2.069081776215293,2.103469210553798,2.816506992659391,2.124976806645285,2.352188308913229,2.485755799543746,2.373718326954115,2.233611725320963,2.095786075159729,2.544523811484098,2.373209908774938,1.943537605860178,2.370324705736556,2.459195894348674,2.322816909293603,2.196510360438978,2.642227306997779,2.191417988439012,2.431928161732891,2.65469836071817,1.856896173145796,2.868801769403056,2.209935714510563,2.569494687128363,2.313888707172215,2.409587305033223,2.625553732206007,2.552767505559165,2.316701556944557,1.783833605979539,1.602127831386952,2.162224827219607,2.059702863504217,2.953811553763489,2.353517447120921,1.77319400210175,1.764579322401749,2.090559493325595,2.472460920354607,2.074643092968918,2.664953132494238,2.54769988230855,2.312649686391933,3.286619963342902,2.242987667830016,2.594615089726355,2.506843518576071,2.376738720961791,2.274763987230211,2.403661980146557,2.308938381499416,2.314435485625285,2.348632303883208,2.361143082979247,2.33212139988037,2.275322824964985,2.353269807858533,2.435215762175694,2.02790073341135,2.311467219018174,2.351811941855377,2.301077783196046,2.292427866616413,2.307073021567872,2.291541408502962,2.348686906536483,2.318969418082172,2.427349722876018,2.279104879807654,1.785350851278835,2.323796594900771,2.326570389725156,2.326434535113592,2.214331910009772,2.337212156310361,2.516330557024608,2.366288980545574,2.510988034988652,2.441090041075363,2.268473053931705,2.237763444456508,2.356837388450312,2.332085244285425,2.293558800841824,2.295895484328214,2.368285079446414,2.320797236953444,2.34159162323333,2.356516035771293,2.282208891903176,2.360732064822395,2.320839869165781,2.323338883561332,2.336955948906496,2.350676628448346,2.44246104581044,2.171265186042413,2.131195066592666,2.076954145499371,2.068896012862278,2.231256557192586,2.359636870210431,2.197104607855822,2.05277558877032,2.367236507027717,2.329778807253228,2.296839824152596,2.145496785561261,2.327143151201361,2.392445225450493,2.41038157430012,2.402174076861946,3.22013802042953,2.78404497318774,2.511768044857669,2.30275851378236,2.125929454726042,2.695507248248548,2.584691117969486,2.241252944420852,2.242052042023292,2.273558142943125,2.43535684584186,2.692406137920107,2.703157968239263,2.077155291412065,2.074187643104598,2.068888167938002,2.081664708340498,2.376358902248242,2.391481964635436,2.344581953234753,2.287849695600633,2.367247910158567,2.354111375607106,2.358605395738063,2.284033495029374,2.051299709043123,2.480544135106683,2.333413229110069,2.811492618673657,2.202613823648605,2.567459661988547,2.690090020216608,2.462629732346443,2.867634907070562,2.144236900385587,3.124560587600199,2.357006278264699,3.063141330020645,2.297288700705741,2.238418662018502,2.190575476465566,2.333823302721383,2.071364513751333,2.295815688265889,2.296801899656317,2.957065031542878,2.905424504700111,1.845610232184423,2.333835748489232,2.247855944532254,2.191276047921119,2.162600160899316,2.048654309772421,2.283990336954537,1.944081490797493,1.889275809384993,2.163504636965888,1.66879916411147,1.832370052161289,1.764588463825662,1.704722538684181,1.991727122004889,2.093262109196416,2.107523420941523,2.076893687228524,2.010492551666978,2.408534706048761,2.47418985861815,2.332973485467894,1.98229248273442,2.33378842884274,2.187229748433689,2.353032124474984,2.211361930571369,2.174308328355794,2.359186791165051,2.358993050390635,2.372582154546768,2.410961317020241,2.36457057061718,2.095209743580022,2.229560194314263,1.921149151227334,2.319740865395848,2.317279009830932,2.293925191086719,2.259558842847651,2.464577904382265,2.326589444257326,2.398116488959575,2.106049761613024,2.078761729715595,2.104734430127403,2.299065057917094,2.344384049712202,2.386209801788144,2.370967124490466,2.380810093097634,2.30513133631633,2.316871232669667,2.324193365620846,2.272021672028254,2.367913309631505,2.314182823447777,2.21368962764585,2.525122791773126,2.331810115778317,2.393365450605536,2.389343885462623,2.581869565354592,2.402491926752655,2.301637023981871,2.335664652733673,2.398282270216984,2.389761132381381,2.404402755989448,2.47153455316186,2.473432687763137,2.263135274698348,2.286241421030079,2.293511609193763,2.337397821563088,2.385235096730691,2.408039272516547,2.370816602413798,2.23705719882154,2.302563361369637,2.32047890577894,2.309487732670516,2.301016729954521,2.29819233073371,2.18792860271334,2.310876027231244,2.409069476219965,2.288155722766722,2.374418663200967,2.154027964845991,2.078053101057109,2.272235143887558,2.873949474539825,2.370091771468408,1.840411874798993,2.262171148807238,2.293811708847703,2.378473985990434,2.161989447686081,2.638914064071838,2.82605939351396,2.221226922387551,2.298140314188198,2.009323713747472,2.322370498257325,2.37987375074966,2.416246795897306,2.257127585876117,2.27125582397784,2.19646942422807,2.239788384398097,2.389954808291309,2.301506135298934,2.34412756981465,2.185962251315846,2.436990183339586,2.400650408464748,2.280680156057586,2.550026754158765,2.365938825518962,2.370288547077743,2.297418236964486,2.331799780403784,2.366943673162487,2.386473292272559,2.406574948353366,2.36777085090664,2.279563931124457,2.371881885293421,2.306387046331552,2.316388731382968,2.344952966304698,2.650527832496671,2.313969700787741,2.325551234126124,2.325547976781643,2.360298379322523,2.338852156575717,2.41011152894476,2.361561234526356,2.772419131298232,2.071379262887749,2.513228809877516,2.486611271024642,2.245583011633136,2.258767792064302,2.463873985590733,2.264004535325013,2.782482670043737,2.334334667639303,2.29594558106527,2.327134445967546,2.359350549200422,2.373934732750945,2.41631195927821,2.435854612674583,2.289435418542214,2.341735726460287,2.344154840330292,2.35986428045377,2.338381113826743,2.278958660525637,2.274096244669722,2.357054096714394,2.288210034556874,2.374734227607166,2.277712265875636,2.356615300956008,2.269111389021892,2.287218812813668,2.269990427828312,2.351558228273389,2.352471070336271,2.346060482071718,2.386922978039288,2.31504578877249,2.263896302767145,2.309457948998312,2.395861170095949,2.249917579735347,2.300759784978918,2.340178509610229,2.36399982144759,2.352073008269999,2.332439057957479,2.389586725487082,2.337714173949593,2.313846985873111,2.344320029380483,2.368374588506561,2.459305169291262,2.366978696331922,2.418976080571107,2.355702693630549,2.426281302729114,2.315759017667161,2.294637946140263,2.34348515541086,2.328619561476425,2.353273948594771,2.171571969834231,2.882571729407534,2.603208465465904,2.413499342148242,2.825077175244184,2.2919742985457,2.005697508672029,2.758888520565657,2.735860899304069,2.39965731977125,2.583935997336682,2.157213287033919,1.949407074248008,3.255327221609779,2.481173334974704,1.832207714873065,3.30232742696966,2.300356645765078,2.312950431098551,2.146851973569103,2.69011253350318,1.703030147760782,2.078342066497133,3.219414938660134,2.326609735475369,3.043058985891345,2.461372148862496,2.873308232150293,2.059634615366267,1.703835163866149,2.358689133857891,3.031774158819189,2.076882325716642,1.889660567760975,1.955233469435145,2.51198594493365,2.479515853856708,2.475381657224125,2.362459916604931,2.352260288141761,2.386102205404945,2.230807709456828,2.760750768911635,2.396786107303705,2.307982312842189,1.809011059016627,2.040704594592193,2.159810135380383,2.463285071466548,2.270747334184076,2.302377435029995,2.454876356509294,2.854125353722253,2.183418864732923,2.695265902213169,2.034515089041474,2.387247377423426,2.192248808771799,2.30195744283848,2.132021251037443,2.025379291893017,2.57179291425262,2.210294165747121,2.229956322216565,2.093646092594168,2.3704427921945,2.356241011977906,2.362384368084524,2.348268457720312,2.327190956114793,2.3138534020291,2.336083997478677,2.351533520375467,2.54308282037325,2.041040461737246,2.23876978688,2.460335576985725,2.285872026986128,2.338539620041771,2.346134789278286,2.514892794422916,2.360781806586044,2.344430648043634,2.332853152744771,2.342522389164025,2.328758942317642,2.505603455788436,2.320621494983075,2.515087514607801,2.519111915220237,2.281154645525793,2.257968339789977,2.361865611449512,2.395145246035074,2.325977946208125,2.283580076852997,2.345227942776678,2.338232550734667,2.334201927927041,2.34658521123944,2.362115523029479,2.395668833739268,2.771465068817354,2.560932832589708,2.573752649616182,2.515404297373218,2.517513728691196,2.666126046588806,2.21526716805976,2.230265320604503,2.260556804684145,2.168683888497732,2.185959193356269,2.238194520131341,2.12261675554399,2.43600151247722,2.298622233018973,2.314080317782413,1.877534066226148,2.134638252536293,2.705405033353243,2.373965243022921,2.43530903714156,2.313638839210642,2.486319478995564,2.726163455377876,2.287310410200813,2.750886483401853,2.759869204735111,2.679356912496012,2.221769509871932,2.073612933434401,3.286435699942194,2.738657281062925,2.478060739212185,2.095127020153494,2.897077518737362,2.08198905481027,2.097500870970695,2.072901370252974,2.764090095567052,2.282132104041919,2.307941791026606,2.364994222620331,2.380113038446166,2.649632770773576,2.494434973890593,2.377758552865005,2.284350368791572,2.369344942900182,2.376451525113084,2.994049733012791,2.313938966495884,2.215045374586059,2.412184221238835,2.340843377547118,2.315255693244002,2.311890635633121,1.993065855145565,2.342241130176652,2.163565111615469,2.147687747421149,2.273064126372833,2.384833811266275,2.367297440707595,2.164022273754897,2.364443779913942,2.314134377111553,2.336951091927573,2.31005634833053,2.698834035255381,2.642937315669312,2.559383749065224,2.390891857625206,2.43342187135356,2.258822270611641,2.289756140389887,2.450606849653117,1.856245446525983,2.134184314657004,1.856840417148203,1.912832022264478,1.84109832772547,1.771477133588025,2.008856359226987,2.050805238189458,2.081635280645168,2.357956080526052,2.076423629601768,2.098242257723119,2.094219490397847,2.348544073677152,2.344453841898126,2.336850039675687,2.075011985721972,2.241580070122372,2.373808331045576,2.199569655659284,2.357937116761853,2.22132491366151,2.133604169272073,2.427182016282299,2.615910977342354,2.443791377210047,2.259758701934832,2.355591888784055,2.03997853237278,1.996414524268929,2.13611486653613,2.137759630983389,2.227068534875862,2.321074575183524,2.542314393327341,2.546235704063298,2.492503770742174,2.350980529184423,2.36465404792601,2.305355032795,2.365116580773126,2.402372202065786,2.40323991543581,2.364520508161645,2.357285106699904,2.120954639140871,2.319649118789304,2.316202043270135,2.388104471987933,2.41419780093719,2.257531297266119,2.392329486075645,2.366818958017002,2.240423393928332,2.417049692505058,2.329250146110546,2.51025922772554,2.48602115388657,2.195997183911022,2.463813010268722,2.347496105549178,2.3680226294592,2.320764329909104,2.24113469525588,2.394334086955501,2.38730264785394,2.416147639258302,2.29503386463781,2.42147966068006,2.413579398489303,2.481855997659998,2.485216771597994,2.273304863217883,2.340628544446673,2.36218344915433,2.294152110036052,2.381379802122569,2.506601060329834,2.234652507364608,2.285864034203317,2.346158985659664,2.533490498887272,2.257682951596856,2.288247879103031,1.901363272805503,2.506046067247012,2.353031673275882,2.07354076984382,2.074061439051923,2.234183951840191,2.942953103552381,2.759245681286698,2.15238091400562,2.416272922426034,2.3496294499087,2.666923870325487,2.534291346805067,2.603013740039935,2.301062218364516,2.270075094528225,2.271241774946841,1.853922005814557,2.069093989456047,1.830884482514259,1.889883586820699,1.701679385877943,1.857686401569586,2.042243084861358,1.848336460941183,2.034360275968888,2.128126761708273,2.472895455894486,2.427072167213128,1.999152822196911,2.357387065004914,2.307006746195415,2.729158520765205,2.25955216421146,2.50135215458537,2.462968817240496,2.375427616295334,2.363536491310628,2.190663346022521,2.209603446433552,2.205169377093938,2.394602435053584,2.386941330289927,2.552665539490675,1.876864330554047,2.280864123932829,1.808451812005219,2.352474753064497,2.572692077845491,2.332043557888983,2.435156535796716,2.432848203936037,2.272282667634794,2.407739772197087,2.279331062587646,2.464303799422027,2.375417048116963,2.334237172104183,2.478634512731602,2.192755744811113,2.397560685779454,2.327249142819286,2.582273481107113,2.319858810573397,2.317276294983628,2.349420678247145,2.328163514621751,2.367501665009157,2.508325640401132,2.304311230595254,2.51402304792492,2.486956850056952,2.157911440400405,2.543759415643631,2.390041496944833,2.29886291886453,2.306855844314376,2.297008384370442,2.511315220726412,2.239459844342923,2.347668779769121,2.365541386616994,2.360348963795693,2.386249154654483,2.297075787218964,2.33515130906629,2.568492790175829,2.32248910666687,2.350752276242783,2.348358789816123,2.134959155141348,2.135153526514122,2.041576259769831,1.921232179931415,2.060746636025829,2.461085712728269,2.26466727263737,2.406093772116971,2.437225106276347,2.34957455440013,2.401479856572119,2.617899869622236,2.091971694055592,2.153086876821334,2.400200498662676,2.329082219238927,2.406862360939802,2.368371229530517,2.37703173677281,2.377266060400594,2.400987581925682,2.381657837226102,2.257075478542532,2.389350715434001,2.382325324343787,2.347794968187123,2.710620712551509,2.773617331034871,2.371834620986367,2.4468448450242,2.172088099622603,2.417611528432184,2.59380010909957,1.704281071232132,2.798846346910329,2.295385065990463,2.505710825373828,2.4636785886463,2.872666643005289,2.070038581836555,2.078728542510472,2.072959968275366,2.074007754555959,2.342175836589614,2.364562701685534,2.320601711289978,2.293769591845626,2.317523160991534,2.348495110241523,2.282232837343052,2.006193215156863,2.350443047910021,3.006792001188619,2.351849903276808,2.40864304813024,2.402609539558431,1.955065429526774,2.384614739745775,2.455091718062988,2.584171814709538,2.302140511192648,2.300203013326458,1.959394925170403,2.137069495975191,2.324422627744729,2.392155619938711,2.248522200813938,2.367023176667636,2.370703701221956,2.392876787156891,2.290959058415162,2.138152050066946,2.421906531373216,3.012169844829695,2.335178011500752,2.332279722058213,2.351782610755281,2.385502011862185,2.523874671212944,2.333100876213595,1.959668397274334,2.152561665748372,2.292492515738362,2.214381405105907,2.291006161226945,2.12142906388291,2.293447190881866,2.180843362233436,1.579698055384501,2.298113531004661,2.031388587062822,2.2562456813314,2.33713168223596,2.19304441912416,1.809931250516282,2.272972353799433,2.577850201089161,2.506176951660518,2.501804517931482,2.432124267829998,2.398805759251851,2.384152392767414,2.376378574969007,2.488168228918638,2.753412114928079,2.319564808257187,2.393298601820045,2.450542712738922,2.359166707796682,2.304815556596478,2.331935270853714,2.319237830657535,2.329700931940062,2.306657227397847,2.36008919965261,2.338621612559207,2.283695411953394,2.449953246582919,2.277395709484811,2.338511939406992,2.371318506148214,2.352229351810214,2.298350343097471,2.376033068376642,2.410569862097879,2.341167337413985,2.348976196879109,2.383058503242899,2.395937704437568,2.277797482353339,2.25845259949167,2.277725990154556,2.31234009252527,2.395853548924634,2.28429070940932,2.408781292903857,2.281357965496288,2.212716924167388,2.192963050286463,2.222979444582405,2.195113061504397,2.292908382045532,2.710374090457945,2.50448982475999,2.309927301923143,2.322395568162884,2.406039057340888,2.398580770693528,2.309494660828499,2.320630120189003,2.440540095406114,2.290032837607437,2.343457080563083,2.256909702742825,2.347286859393761,2.394645723101695,2.258265582623542,2.383498053635828,2.379272760660398,2.282436352105566,2.357168503499223,2.348753947399345,2.330590185443952,2.34397828465711,2.286208866350449,2.307184423479289,2.358470717949198,2.404429815249665,2.304638295840522,2.340665370711046,2.309451568531601,2.301117500243332,2.289336994534142,2.36283049366405,2.379349760108144,2.401551628495893,2.322610304529139,2.327897122247714,2.243524269232802,2.167642290700019,2.51278309122102,1.99955746456171,2.350527871891445,2.46153343032106,2.566390086776487,2.842142893262073,2.15267474477223,2.229450836814318,2.637696456903432,1.919165109644879,2.764186312987929,2.200722651539586,2.263820372360015,2.044607572562788,2.242876431788327,1.629810374909787,2.287844152886833,2.315928252246651,2.270467157461876,2.040797728896378,2.058148579609909,2.49395500157786,2.473444923101952,2.888069196009353,2.800452794196211,2.002943400674972,1.902123827453471,2.290901633788736,1.871848817187758,2.393486958683708,2.633014054664821,2.705948671072856,1.943050308538027,2.487860539469699,3.12469776889967,1.84494574077588,2.391677280020743,2.25967784528176,2.1970921514919,2.993273552080551,2.263200314131186,2.306793393920284,2.362235875755073,3.081261311573344,2.259311934763262,1.921411603332237,1.936866045742165,2.027614405043223,1.541816052099092,2.533188729235158,2.691869674891787,1.582047851317821,2.378611692928766,2.216160407184289,2.704026215442977,2.174916445478343,2.495597300678965,2.561399093054099,2.077726580284363,2.286574957851777,2.368441604091807,2.387635123244743,2.375024140213053,2.316125713144126,2.296625935042547,2.325805665664956,2.353879277688042,2.365299037717126,2.36379659258117,2.364782211229301,2.309963916674964,2.437093081389857,2.295733381208044,2.168824623180724,2.33673635834888,2.409644765993137,2.362370422777837,1.702073164627699,2.506641296314338,2.31428282641143,2.365943375901103,2.343787593069538,2.339594058089634,2.356690960000734,2.391792080434786,2.499581315044192,2.516465926853333,2.411251538241175,2.496663961265173,2.421755745484431,2.343608980588164,2.281968996300583,2.346762250537196,2.288752403206001,2.338323714633384,2.29480255885222,2.400015839150951,2.383236485883081,2.393812824248049,2.373163448989042,2.358412145806997,2.331915966148056,2.33332466417193,2.313329434351048,2.355461243831355,2.320414479448549,2.354454550298998,2.127918451465639,2.425371128614129,2.384209773474595,2.57097321407842,2.515678661416922,2.263579165122434,2.654925559297396,2.09859869282142,1.943351304051261,1.830789694675553,2.061778207548135,1.602736345725471,2.082825775500571,2.242194150886193,2.079921925309759,2.090941316610213,2.189019441161834,2.451461334504632,2.471845314647001,2.308643327569105,2.466101920988312,2.027609190942715,2.039405640870291,2.377536649333528,2.28089763801081,2.365936462786417,2.18487829375217,2.278367597793364,2.182419865603173,2.287827610637093,2.264032503465514,1.856409435564234,1.91377096449074,2.216963537511007,2.371690766929354,2.460866125373067,2.359942486223148,2.256341370008037,2.404231222725954,2.097496390224522,2.440938542148581,2.32964649112268,2.425002343412562,2.31763597349553,2.317444747567045,2.258848802142857,2.330823632623241,2.273052651467429,2.376982009935541,2.356086699550775,2.339024597780679,2.321792440596098,2.45327835739289,2.323345595149918,2.342604533249601,2.494347594511731,2.300646597115273,2.377580911155868,2.35733684149807,2.229107306546342,2.344674158888917,2.33939872903889,2.385018588320143,2.296491823547256,2.639344375306953,2.312379081245173,2.526124742884248,2.35786508084631,2.352465656658599,2.342058969968178,2.34385592292869,2.39329710863814,2.327213722992514,2.314894725859618,2.377615029759566,2.426010649969479,2.29594403505965,2.238446899537368,2.32445617871616,2.410691753149137,2.415343724259999,2.496099154657767,2.050419959228416,2.19362542690673,2.050342087680914,2.294141759113527,2.290152085299062,2.301050341112269,2.151635219905435,2.073343632397534,2.357485039419386,2.783368598198454,2.42272757877871,2.376568061709563,3.024061078332919,2.288935632954236,1.963479417523357,2.231969689318908,2.303186371275999,2.402026285481928,2.526672402896376,2.327237846477684,2.333213881034935,1.982930931921034,2.30421031263815,2.258732114503323,2.472239033742717,2.369116808305934,2.345479004987329,2.426437660357804,2.477713962139221,2.289656249386548,2.134334057971429,2.18532910013064,2.704952620477987,2.472905773786876,2.407632799770039,2.285703010240149,2.221919675372392,2.406965103982301,2.287629178858982,2.278108139667144,2.345082368297629,2.333030173516248,2.386519665168257,2.297040066327876,2.340088221364073,2.269757488402505,2.47957321666944,2.32748523326477,2.270882826134788,2.273591896827077,2.329260165223591,2.321876648838,2.331137409211793,2.449163556973172,2.238164153990337,2.357927594030113,2.328336726884543,2.328760196595872,2.313429616415002,2.359489319173389,2.36463871580617,2.432576788377327,2.233331740583947,2.237323316346558,2.580094477674681,2.616660632260988,2.273944350132215,2.312278371096819,2.322701156379402,2.38503392013255,2.293878526544948,2.291971482074161,2.3213762390463,2.402320884604555,2.393042676746961,2.295031868637263,2.36826364714353,2.392088512899463,2.39052097382167,2.337502927537977,2.386533232854602,2.381597644317651,2.400867131995259,2.284886109528691,2.415914818248825,2.333666174532636,2.351739017496123,2.239056950229608,2.434860089165397,2.368153688128654,2.404130260931261,2.361792288696718,2.373709389692876,2.302914837310875,2.349473887846036,2.285860612171984,2.318352368843227,2.322538109767929,2.26690547594029,2.228312589822806,2.327556486343074,2.230505084345108,2.360925588891195,2.271904762259129,2.293229272702139,2.322226704934435,2.354864434041354,2.422349588326147,2.314165679799812,2.237924450624873,2.364726584402536,2.403156304681302,2.328943443513662,2.333960863627033,2.33077593850827,2.280234505496629,2.370521893128131,2.370792504301474,2.325686386665735,2.326495801186323,2.27803679359566,2.27802386960161,2.259732466733691,2.426416846055341,2.43868433791374,2.130140387398266,2.134901193297192,2.192544590906623,2.201902783846339,1.970539527307775,1.668658991069701,2.306796241796371,2.542610119520444,2.312960895970202,2.154523769499145,2.401034634639267,2.279948779960805,2.907470032891877,2.825653262436837,2.152819846189617,2.032491061396556,2.205431620331407,2.096537371056845,1.715126626540476,2.420035661538412,1.747400177113137,2.257193702403082,1.913458907563275,2.216551458899091,2.513050077761048,2.425825630991127,2.896889346738567,2.138229986949461,3.007871639575125,2.185168881790716,2.317279009830932,2.434838731935017,2.367812045734313,2.187092738897712,2.525397824820007,2.43002496354165,2.809640024146965,1.809132364180383,2.122649064863787,2.618489418461884,2.008755261643798,2.337118527524094,3.062662265721285,2.297471581707085,2.583373842826077,2.189419025340414,2.188589480673594,3.026082455866731,2.798908999063588,2.257005196004971,2.011572228975412,2.274806827818215,2.69154259442922,1.875588757750981,2.279679514996291,1.848953561206737,2.283211433587319,2.003750616855877,2.389992502157507,2.315589845753502,2.30568438831725,2.315872610015877,2.362204180849706,2.366973432519157,2.343594069990476,2.274694153457738,2.33650763856632,1.541945953448386,2.293969543847925,2.367519133518827,2.333415247513803,2.295628977410447,2.248917409023866,2.323950526620313,2.401442679355225,2.465004561365975,2.335205075483803,2.332813258985184,2.331127375885564,2.273576549297049,2.331646281502548,2.327977479041367,2.37117760080807,2.427116628207101,2.425646434402894,2.487227090561552,2.51860173793969,2.521071607636472,2.180720673559799,2.326697070048284,2.349111382267233,2.515318639952558,2.511938656746867,2.512331331757931,2.281365900115828,2.399102843717162,2.394893545665479,2.329540823706517,2.378317879391437,2.394625613272105,2.288274503107299,2.354650327079734,2.330801239172808,2.398687219251816,2.333979548338739,2.815605087774299,1.936545725682747,1.948935901788012,2.17060881653794,2.229309864603976,2.302931852140175,2.271464247812916,2.37442885712287,2.25591782928365,2.398460441992487,2.38162669333873,2.382160692601649,2.321024780008962,2.68643888775321,2.313921320612209,2.259187909442973,2.709382799167131,2.354358787637416,1.630518128639352,2.692048582280792,2.72657628964931,2.548270529325419,2.291299404156091,2.367960704266046,2.297380676664083,2.447901026095871,2.460122607703222,1.745718817328666,2.734296836715729,2.525216108842239,2.079136147795535,2.061594110490107,2.079542793390018,2.070307945975927,2.419867197830844,3.042405617073094,2.433415222396392,2.326945575976116,2.312735069577009,2.35739018571947,2.355969834930796,2.340942705575037,2.376737738673425,2.908206738274958,2.143611314416376,2.483311124803059,2.42357447101627,2.825075731917852,2.324438717925654,3.031610223970069,2.47765750677,2.159964744057718,2.571657323382317,2.07485429089805,2.954629231238556,2.280002022090569,2.372837696922592,2.299221924483929,2.297682700878561,2.238164123162937,2.237395857565668,2.437942523015427,2.34074384375247,2.28486822134937,2.517041179053647,2.211779562973602,2.145127532070035,2.19399973757299,2.050867098993266,2.257907925380545,2.317191227192257,2.277698726153069,2.306410776591465,2.128278383063467,1.815092384962444,2.188335307495899,2.168917918066161],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[48.83900527972955,2.336665488965441],11,[]],"limits":{"lat":[48.18117262779692,49.16299690634341],"lng":[1.541816052099092,3.302627199099271]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p>With this graph about the daily ridership data, we observe a regular drop of validations each year at the same month, mostly in july and especially august. It’s due to the students and workers mostly going on vacations in august and thus stopping to use the network.</p>
<p>We can also observe a massive drop in early 2020, because of the covid-19 and the lockdown, so almost no one was using the network during this time. From the second semester of 2020 to the end 2022, we can see the number of users rise again with the same trends in july/august until 2023 when all restrictions were lifted and people used the network in a pre-covid amount again.</p></li>
<li><p>Return a summary table showing the top three LIBELLE_ARRET based on the total number of validations Sum_NB_VALD which are la defense ,sain-lazare and gare de lyon. It is very logical to find these stations because they are very popular stations in Paris.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select and arrange the top 3 LIBELLE_ARRET based on NB_VALD</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>top_arrets <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LIBELLE_ARRET) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_NB_VALD =</span> <span class="fu">sum</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">3</span>, Total_NB_VALD) <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_NB_VALD))</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_arrets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  LIBELLE_ARRET           Total_NB_VALD
  &lt;chr&gt;                           &lt;dbl&gt;
1 LA DEFENSE-GRANDE ARCHE    1857951808
2 SAINT-LAZARE               1301371985
3 GARE DE LYON               1257794160</code></pre>
</div>
</div>
<ul>
<li><p>We zoomed for the first 3 months of the data because when we used the whole data the graph was too dense, we had a black graph as a result. Zooming was a solution to detect the seasonality.</p></li>
<li><p>As we can see in the graph below there is a weekly seasonality. Each week there is a huge drop in the use of the transportation network in France. we used frequency = 7 because our unit of time is per day.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> final_data<span class="sc">$</span>Sum_NB_VALD[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">3</span> <span class="sc">*</span> <span class="dv">60</span>)]  <span class="co">#We put 60 because we have 2 lines for each day (the entries for each station). 3*60 is equivalent to 3 months.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set frequency to 7 for weekly seasonality (adjust as needed)</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>decomposition <span class="ot">&lt;-</span> <span class="fu">decompose</span>(<span class="fu">ts</span>(subset_data, <span class="at">frequency =</span> <span class="dv">7</span>))</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the decomposed time series</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomposition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> final_data<span class="sc">$</span>Sum_NB_VALD[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">24</span> <span class="sc">*</span> <span class="dv">60</span>)]  <span class="co">#We put 60 because we have 2 lines for each day (the entries for each station). 24*60 is equivalent to 2 years.</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set frequency to 364 for yearly seasonality (adjust as needed)</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>decomposition <span class="ot">&lt;-</span> <span class="fu">decompose</span>(<span class="fu">ts</span>(subset_data, <span class="at">frequency =</span> <span class="dv">364</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the decomposed time series</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomposition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>We used only 2 years to see yearly seasonality because the data is too large (and as a result the graph becomes too dense). As we can see there is a seasonality because in august the use of transportation becomes less frequent as well as the yearly holidays.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot monthly trends</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(final_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">format</span>(JOUR, <span class="st">"%Y-%m"</span>), <span class="at">y =</span> Sum_NB_VALD)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Average Ridership"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean NB_VALD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>We notice a trend every 12 months, also there is a drop in the number of validations in august for each year. But for 2020 there is a drop for almost the whole year because of COVID19 (especially the in the CURFEW period).</p></li>
<li><p>The covid in 2020 caused a drop of the number of validations which is like an outlier that will affect the data and its seasonality.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>final_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,274,003 × 6
# Groups:   ID_REFA_LDA, JOUR [1,657,582]
   ID_REFA_LDA JOUR       LIBELLE_ARRET    Sum_NB_VALD ZdAYEpsg2154 ZdAXEpsg2154
   &lt;chr&gt;       &lt;date&gt;     &lt;chr&gt;                  &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1 411281      2017-01-01 LYCEE HENRI SEL…          63      6868624       664446
 2 411281      2017-01-01 LYCEE HENRI SEL…          63      6868564       664461
 3 411281      2017-02-01 LYCEE HENRI SEL…         881      6868624       664446
 4 411281      2017-02-01 LYCEE HENRI SEL…         881      6868564       664461
 5 411281      2017-03-01 LYCEE HENRI SEL…         833      6868624       664446
 6 411281      2017-03-01 LYCEE HENRI SEL…         833      6868564       664461
 7 411281      2017-04-01 LYCEE HENRI SEL…         306      6868624       664446
 8 411281      2017-04-01 LYCEE HENRI SEL…         306      6868564       664461
 9 411281      2017-05-01 LYCEE HENRI SEL…         132      6868624       664446
10 411281      2017-05-01 LYCEE HENRI SEL…         132      6868564       664461
# ℹ 4,273,993 more rows</code></pre>
</div>
</div>
<p><code>{ubridate)}</code></p>
<ul>
<li>Extract the day of the week using lubridate. Creating a new column called Weekday</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>Weekday <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(final_data<span class="sc">$</span>JOUR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Creating a new column indicating holiday or non-holiday called HolidayType</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify holiday periods </span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>holidays <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2017-12-25"</span>, <span class="st">"2018-01-01"</span>, <span class="st">"2018-07-14"</span>, <span class="st">"2018-12-25"</span>, <span class="st">"2019-01-01"</span>, <span class="st">"2019-07-14"</span>, <span class="st">"2019-12-25"</span>, <span class="st">"2020-01-01"</span>, <span class="st">"2020-07-14"</span>, <span class="st">"2020-12-25"</span>, <span class="st">"2021-01-01"</span>, <span class="st">"2021-07-14"</span>, <span class="st">"2021-12-25"</span>, <span class="st">"2022-01-01"</span>, <span class="st">"2022-07-14"</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable indicating holiday or non-holiday</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>HolidayType <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">floor_date</span>(final_data<span class="sc">$</span>JOUR, <span class="st">"day"</span>) <span class="sc">%in%</span> holidays, <span class="st">"Holiday"</span>, <span class="st">"Non-Holiday"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Group by weekday and calculate the mean for each day of the week</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by weekday and calculate the mean for each day of the week</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mean_by_weekday <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Weekday, HolidayType) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean_Sum_NB_VALD =</span> <span class="fu">mean</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Weekday'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<ul>
<li>Calculate the mean for holiday days</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean for holiday days</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>mean_holiday <span class="ot">&lt;-</span> mean_by_weekday <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(HolidayType <span class="sc">==</span> <span class="st">"Holiday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean_Sum_NB_VALD_Holiday =</span> <span class="fu">mean</span>(Mean_Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Plot the comparison</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mean_by_weekday, <span class="fu">aes</span>(<span class="at">x =</span> Weekday, <span class="at">y =</span> Mean_Sum_NB_VALD, <span class="at">color =</span> HolidayType)) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(data = mean_holiday, aes(x = "Holiday", y = Mean_Sum_NB_VALD_Holiday), size = 3, color = "red") +</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Sum_NB_VALD Comparison"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Day of the Week"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean Sum_NB_VALD"</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Period"</span>) <span class="sc">+</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>This scatter plot shows the average number of validations (number of people using the network) for each day of the week. It compares holidays and non holidays. As one could expect, less people use public transportation on holidays than non holidays, for the usual work days of the week. it’s only different for Sunday, where more people us the transports during holidays than non holidays, because the number of users was already significantly lower than the other days.</li>
</ul>
</section>
<section id="comparison-with-norms" class="level3">
<h3 class="anchored" data-anchor-id="comparison-with-norms">4. Comparison with Norms</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to check if a date is within a special period</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>is_special_period <span class="ot">&lt;-</span> <span class="cf">function</span>(date, special_periods) {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">any</span>(date <span class="sc">%in%</span> special_periods))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the range of years in your dataset</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>data_years <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">year</span>(final_data<span class="sc">$</span>JOUR))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Below, we create a special periods variable containing the school holidays (December and February) for each year.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty vector to store special periods</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>special_periods <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each year and add sequences to the special_periods vector</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year_val <span class="cf">in</span> data_years) {</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  start_date1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">sprintf</span>(<span class="st">"%d-12-17"</span>, year_val))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  end_date1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">sprintf</span>(<span class="st">"%d-01-03"</span>, year_val <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  start_date2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">sprintf</span>(<span class="st">"%d-02-04"</span>, year_val))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  end_date2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">sprintf</span>(<span class="st">"%d-02-20"</span>, year_val))</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  special_periods <span class="ot">&lt;-</span> <span class="fu">c</span>(special_periods, <span class="fu">seq</span>(start_date1, end_date1, <span class="at">by =</span> <span class="st">"days"</span>), <span class="fu">seq</span>(start_date2, end_date2, <span class="at">by =</span> <span class="st">"days"</span>))</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert numerical representations to dates</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>special_periods <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(special_periods, <span class="at">origin=</span><span class="st">"1970-01-01"</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(special_periods)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "2017-12-17" "2017-12-18" "2017-12-19" "2017-12-20" "2017-12-21"
  [6] "2017-12-22" "2017-12-23" "2017-12-24" "2017-12-25" "2017-12-26"
 [11] "2017-12-27" "2017-12-28" "2017-12-29" "2017-12-30" "2017-12-31"
 [16] "2018-01-01" "2018-01-02" "2018-01-03" "2017-02-04" "2017-02-05"
 [21] "2017-02-06" "2017-02-07" "2017-02-08" "2017-02-09" "2017-02-10"
 [26] "2017-02-11" "2017-02-12" "2017-02-13" "2017-02-14" "2017-02-15"
 [31] "2017-02-16" "2017-02-17" "2017-02-18" "2017-02-19" "2017-02-20"
 [36] "2018-12-17" "2018-12-18" "2018-12-19" "2018-12-20" "2018-12-21"
 [41] "2018-12-22" "2018-12-23" "2018-12-24" "2018-12-25" "2018-12-26"
 [46] "2018-12-27" "2018-12-28" "2018-12-29" "2018-12-30" "2018-12-31"
 [51] "2019-01-01" "2019-01-02" "2019-01-03" "2018-02-04" "2018-02-05"
 [56] "2018-02-06" "2018-02-07" "2018-02-08" "2018-02-09" "2018-02-10"
 [61] "2018-02-11" "2018-02-12" "2018-02-13" "2018-02-14" "2018-02-15"
 [66] "2018-02-16" "2018-02-17" "2018-02-18" "2018-02-19" "2018-02-20"
 [71] "2019-12-17" "2019-12-18" "2019-12-19" "2019-12-20" "2019-12-21"
 [76] "2019-12-22" "2019-12-23" "2019-12-24" "2019-12-25" "2019-12-26"
 [81] "2019-12-27" "2019-12-28" "2019-12-29" "2019-12-30" "2019-12-31"
 [86] "2020-01-01" "2020-01-02" "2020-01-03" "2019-02-04" "2019-02-05"
 [91] "2019-02-06" "2019-02-07" "2019-02-08" "2019-02-09" "2019-02-10"
 [96] "2019-02-11" "2019-02-12" "2019-02-13" "2019-02-14" "2019-02-15"
[101] "2019-02-16" "2019-02-17" "2019-02-18" "2019-02-19" "2019-02-20"
[106] "2020-12-17" "2020-12-18" "2020-12-19" "2020-12-20" "2020-12-21"
[111] "2020-12-22" "2020-12-23" "2020-12-24" "2020-12-25" "2020-12-26"
[116] "2020-12-27" "2020-12-28" "2020-12-29" "2020-12-30" "2020-12-31"
[121] "2021-01-01" "2021-01-02" "2021-01-03" "2020-02-04" "2020-02-05"
[126] "2020-02-06" "2020-02-07" "2020-02-08" "2020-02-09" "2020-02-10"
[131] "2020-02-11" "2020-02-12" "2020-02-13" "2020-02-14" "2020-02-15"
[136] "2020-02-16" "2020-02-17" "2020-02-18" "2020-02-19" "2020-02-20"
[141] "2021-12-17" "2021-12-18" "2021-12-19" "2021-12-20" "2021-12-21"
[146] "2021-12-22" "2021-12-23" "2021-12-24" "2021-12-25" "2021-12-26"
[151] "2021-12-27" "2021-12-28" "2021-12-29" "2021-12-30" "2021-12-31"
[156] "2022-01-01" "2022-01-02" "2022-01-03" "2021-02-04" "2021-02-05"
[161] "2021-02-06" "2021-02-07" "2021-02-08" "2021-02-09" "2021-02-10"
[166] "2021-02-11" "2021-02-12" "2021-02-13" "2021-02-14" "2021-02-15"
[171] "2021-02-16" "2021-02-17" "2021-02-18" "2021-02-19" "2021-02-20"
[176] "2022-12-17" "2022-12-18" "2022-12-19" "2022-12-20" "2022-12-21"
[181] "2022-12-22" "2022-12-23" "2022-12-24" "2022-12-25" "2022-12-26"
[186] "2022-12-27" "2022-12-28" "2022-12-29" "2022-12-30" "2022-12-31"
[191] "2023-01-01" "2023-01-02" "2023-01-03" "2022-02-04" "2022-02-05"
[196] "2022-02-06" "2022-02-07" "2022-02-08" "2022-02-09" "2022-02-10"
[201] "2022-02-11" "2022-02-12" "2022-02-13" "2022-02-14" "2022-02-15"
[206] "2022-02-16" "2022-02-17" "2022-02-18" "2022-02-19" "2022-02-20"
[211] "2023-12-17" "2023-12-18" "2023-12-19" "2023-12-20" "2023-12-21"
[216] "2023-12-22" "2023-12-23" "2023-12-24" "2023-12-25" "2023-12-26"
[221] "2023-12-27" "2023-12-28" "2023-12-29" "2023-12-30" "2023-12-31"
[226] "2024-01-01" "2024-01-02" "2024-01-03" "2023-02-04" "2023-02-05"
[231] "2023-02-06" "2023-02-07" "2023-02-08" "2023-02-09" "2023-02-10"
[236] "2023-02-11" "2023-02-12" "2023-02-13" "2023-02-14" "2023-02-15"
[241] "2023-02-16" "2023-02-17" "2023-02-18" "2023-02-19" "2023-02-20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>SpecialPeriod <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(final_data<span class="sc">$</span>JOUR <span class="sc">%in%</span> special_periods)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Group by weekday and special period, calculate the mean for each day</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by weekday and special period, calculate the mean for each day</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>mean_by_weekday_and_special_period <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Weekday, SpecialPeriod) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean_Sum_NB_VALD =</span> <span class="fu">mean</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Weekday'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the comparison</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mean_by_weekday_and_special_period, <span class="fu">aes</span>(<span class="at">x =</span> Weekday, <span class="at">y =</span> Mean_Sum_NB_VALD, <span class="at">color =</span> SpecialPeriod)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Sum_NB_VALD Comparison"</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Day of the Week"</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean Sum_NB_VALD"</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Special Period"</span>) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>We conclude that in school days the transportation tools are more used than in school vacation ones, also Sunday in France people don’t usually leave their homes that’s why there ’s a drop for both there.</p>
<h3 id="dashboard-development-using-shiny" class="anchored">5. Dashboard Development using Shiny</h3></li>
</ul>
<!-- -->
<ul>
<li>We used only 10000 points of the data because it is very slow and the pc crashes when using the whole data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>copy <span class="ot">&lt;-</span> final_data</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>final_data1 <span class="ot">&lt;-</span> <span class="fu">head</span>(final_data,<span class="dv">10000</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define UI</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"Ridership Comparison"</span>),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dateInput</span>(<span class="st">"start_date_ref"</span>, <span class="st">"Select Reference Start Date:"</span>, <span class="at">value =</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-01"</span>)),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dateInput</span>(<span class="st">"end_date_ref"</span>, <span class="st">"Select Reference End Date:"</span>, <span class="at">value =</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-03"</span>)),</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dateInput</span>(<span class="st">"start_date_comp"</span>, <span class="st">"Select Comparison Start Date:"</span>, <span class="at">value =</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-07"</span>)),</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dateInput</span>(<span class="st">"end_date_comp"</span>, <span class="st">"Select Comparison End Date:"</span>, <span class="at">value =</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-10"</span>)),</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">leafletOutput</span>(<span class="st">"map_station"</span>),</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">br</span>()</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tabsetPanel</span>(</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tabPanel</span>(<span class="st">"Ridership Comparison"</span>, </span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">plotOutput</span>(<span class="st">"ridership_comparison"</span>),</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">tableOutput</span>(<span class="st">"station_stats"</span>)),</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tabPanel</span>(<span class="st">"Station Statistics"</span>, </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">selectInput</span>(<span class="st">"station_name"</span>, <span class="st">"Select Station:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(final_data1<span class="sc">$</span>LIBELLE_ARRET), <span class="at">selected =</span> <span class="st">"PERNETY"</span>),</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">tableOutput</span>(<span class="st">"station_stats_tab"</span>)),</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tabPanel</span>(<span class="st">"Holiday Statistics"</span>,</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">selectInput</span>(<span class="st">"holiday_type"</span>, <span class="st">"Select Holiday Type:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(final_data1<span class="sc">$</span>HolidayType), <span class="at">selected =</span> <span class="st">"Public"</span>),</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">tableOutput</span>(<span class="st">"holiday_stats_tab"</span>))</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define server</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data based on user inputs</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  filtered_data_ref <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    final_data1 <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(JOUR <span class="sc">&gt;=</span> input<span class="sc">$</span>start_date_ref, JOUR <span class="sc">&lt;=</span> input<span class="sc">$</span>end_date_ref)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  filtered_data_comp <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>    final_data1 <span class="sc">%&gt;%</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(JOUR <span class="sc">&gt;=</span> input<span class="sc">$</span>start_date_comp, JOUR <span class="sc">&lt;=</span> input<span class="sc">$</span>end_date_comp)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update ridership comparison plot based on filtered data</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>ridership_comparison <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">filtered_data_ref</span>(), <span class="fu">aes</span>(<span class="at">x =</span> JOUR, <span class="at">y =</span> Sum_NB_VALD, <span class="at">color =</span> Weekday), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">filtered_data_comp</span>(), <span class="fu">aes</span>(<span class="at">x =</span> JOUR, <span class="at">y =</span> Sum_NB_VALD, <span class="at">color =</span> Weekday), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ridership Comparison"</span>,</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">"Total Validations"</span>,</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"Day of the Week"</span>) <span class="sc">+</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  filtered_new_data <span class="ot">&lt;-</span> new_data <span class="sc">%&gt;%</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ZdCId <span class="sc">%in%</span> final_data1<span class="sc">$</span>ID_REFA_LDA) </span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(filtered_new_data)</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  final_data_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(filtered_new_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"ZdAXEpsg2154"</span>, <span class="st">"ZdAYEpsg2154"</span>), <span class="at">crs =</span> <span class="dv">2154</span>)</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>  final_data_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(final_data_sf, <span class="dv">4326</span>)  <span class="co"># Transform to EPSG 4326</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  filtered_new_data<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(final_data_sf)[, <span class="st">"X"</span>]</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  filtered_new_data<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(final_data_sf)[, <span class="st">"Y"</span>]</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a leaflet map for station selection</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>map_station <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>({</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setView</span>(<span class="at">lng =</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(final_data_sf<span class="sc">$</span>geometry)[,<span class="st">"X"</span>]), <span class="at">lat =</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(final_data_sf<span class="sc">$</span>geometry)[,<span class="st">"Y"</span>]), <span class="at">zoom =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addMarkers</span>(<span class="at">data =</span> final_data_sf, <span class="at">lng =</span> <span class="fu">st_coordinates</span>(final_data_sf<span class="sc">$</span>geometry)[,<span class="st">"X"</span>], <span class="at">lat =</span> <span class="fu">st_coordinates</span>(final_data_sf<span class="sc">$</span>geometry)[,<span class="st">"Y"</span>])</span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Observe the selection on the map and update station statistics</span></span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>map_station_marker_click, {</span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>    click <span class="ot">&lt;-</span> input<span class="sc">$</span>map_station_marker_click</span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(click)) {</span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a>      lat <span class="ot">&lt;-</span> click<span class="sc">$</span>lat</span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>      lng <span class="ot">&lt;-</span> click<span class="sc">$</span>lng</span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(lat)</span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(lng)</span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">str_sub</span>(<span class="fu">as.character</span>(lng), <span class="at">end =</span> <span class="dv">7</span>))</span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a>      id <span class="ot">=</span> filtered_new_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="fu">as.character</span>(X), <span class="fu">str_sub</span>(<span class="fu">as.character</span>(lng), <span class="at">end =</span> <span class="dv">7</span>))) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="fu">as.character</span>(Y), <span class="fu">str_sub</span>(<span class="fu">as.character</span>(lat), <span class="at">end =</span> <span class="dv">7</span>))) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ZdCId)</span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(id)</span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Filter final_data1 based on the clicked coordinates</span></span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a>      selected_station <span class="ot">&lt;-</span> final_data1 <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(ID_REFA_LDA<span class="sc">==</span>id<span class="sc">$</span>ZdCId[<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(LIBELLE_ARRET) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(selected_station)</span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a>      output<span class="sc">$</span>station_stats <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a>        summarise_data <span class="ot">&lt;-</span> final_data1 <span class="sc">%&gt;%</span></span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(LIBELLE_ARRET <span class="sc">%in%</span> selected_station<span class="sc">$</span>LIBELLE_ARRET) <span class="sc">%&gt;%</span></span>
<span id="cb80-63"><a href="#cb80-63" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(LIBELLE_ARRET, Weekday) <span class="sc">%&gt;%</span></span>
<span id="cb80-64"><a href="#cb80-64" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(</span>
<span id="cb80-65"><a href="#cb80-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_Validations =</span> <span class="fu">sum</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-66"><a href="#cb80-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">Avg_Validations =</span> <span class="fu">mean</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-67"><a href="#cb80-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max_Validations =</span> <span class="fu">max</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-68"><a href="#cb80-68" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb80-69"><a href="#cb80-69" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(summarise_data)</span>
<span id="cb80-70"><a href="#cb80-70" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb80-71"><a href="#cb80-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-72"><a href="#cb80-72" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-73"><a href="#cb80-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-74"><a href="#cb80-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add server logic for the "Station Statistics" tab</span></span>
<span id="cb80-75"><a href="#cb80-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>station_name, {</span>
<span id="cb80-76"><a href="#cb80-76" aria-hidden="true" tabindex="-1"></a>    selected_station <span class="ot">&lt;-</span> final_data1 <span class="sc">%&gt;%</span></span>
<span id="cb80-77"><a href="#cb80-77" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(LIBELLE_ARRET <span class="sc">==</span> input<span class="sc">$</span>station_name) <span class="sc">%&gt;%</span></span>
<span id="cb80-78"><a href="#cb80-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(LIBELLE_ARRET) <span class="sc">%&gt;%</span> </span>
<span id="cb80-79"><a href="#cb80-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>()</span>
<span id="cb80-80"><a href="#cb80-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-81"><a href="#cb80-81" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>station_stats_tab <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb80-82"><a href="#cb80-82" aria-hidden="true" tabindex="-1"></a>      summarise_data <span class="ot">&lt;-</span> final_data1 <span class="sc">%&gt;%</span></span>
<span id="cb80-83"><a href="#cb80-83" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(LIBELLE_ARRET <span class="sc">%in%</span> selected_station<span class="sc">$</span>LIBELLE_ARRET) <span class="sc">%&gt;%</span></span>
<span id="cb80-84"><a href="#cb80-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(LIBELLE_ARRET, Weekday) <span class="sc">%&gt;%</span></span>
<span id="cb80-85"><a href="#cb80-85" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(</span>
<span id="cb80-86"><a href="#cb80-86" aria-hidden="true" tabindex="-1"></a>          <span class="at">Total_Validations =</span> <span class="fu">sum</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-87"><a href="#cb80-87" aria-hidden="true" tabindex="-1"></a>          <span class="at">Avg_Validations =</span> <span class="fu">mean</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-88"><a href="#cb80-88" aria-hidden="true" tabindex="-1"></a>          <span class="at">Max_Validations =</span> <span class="fu">max</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-89"><a href="#cb80-89" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb80-90"><a href="#cb80-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(summarise_data)</span>
<span id="cb80-91"><a href="#cb80-91" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb80-92"><a href="#cb80-92" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-93"><a href="#cb80-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-94"><a href="#cb80-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add server logic for the "Holiday Statistics" tab</span></span>
<span id="cb80-95"><a href="#cb80-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>holiday_type, {</span>
<span id="cb80-96"><a href="#cb80-96" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>holiday_stats_tab <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb80-97"><a href="#cb80-97" aria-hidden="true" tabindex="-1"></a>      summarise_data <span class="ot">&lt;-</span> final_data1 <span class="sc">%&gt;%</span></span>
<span id="cb80-98"><a href="#cb80-98" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(HolidayType <span class="sc">==</span> input<span class="sc">$</span>holiday_type) <span class="sc">%&gt;%</span></span>
<span id="cb80-99"><a href="#cb80-99" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(LIBELLE_ARRET, Weekday) <span class="sc">%&gt;%</span></span>
<span id="cb80-100"><a href="#cb80-100" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(</span>
<span id="cb80-101"><a href="#cb80-101" aria-hidden="true" tabindex="-1"></a>          <span class="at">Total_Validations =</span> <span class="fu">sum</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-102"><a href="#cb80-102" aria-hidden="true" tabindex="-1"></a>          <span class="at">Avg_Validations =</span> <span class="fu">mean</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-103"><a href="#cb80-103" aria-hidden="true" tabindex="-1"></a>          <span class="at">Max_Validations =</span> <span class="fu">max</span>(Sum_NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-104"><a href="#cb80-104" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb80-105"><a href="#cb80-105" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(summarise_data)</span>
<span id="cb80-106"><a href="#cb80-106" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb80-107"><a href="#cb80-107" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-108"><a href="#cb80-108" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the application</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>This is a screenshot on how the shiny app works:</p>
<p><img src="Images/UISHiny.png" class="img-fluid"></p>
</section>
<section id="statistical-methods" class="level3">
<h3 class="anchored" data-anchor-id="statistical-methods"><img src="Images/ShinyUiPanel2.png" class="img-fluid"><img src="Images/SHinyUIPanel3.png" class="img-fluid">6. Statistical Methods</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data<span class="sc">$</span>Sum_NB_VALD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0     819    3746    7536    8791  255072 </code></pre>
</div>
</div>
<ul>
<li><p>This summary provides insights into the distribution of the number of validations, including central tendency (mean, median) and dispersion (range, quartiles).</p></li>
<li><p>The mean represents the average value of the data set, calculated by adding up all the values and dividing by the number of observations. In this case, the mean number of validations is 7536.</p></li>
<li><p>The median is the middle value of the data set when it is sorted in ascending order. In this case, the median number of validations is 3746, which means that half of the observations have a number of validations below 3746, and half have a number of validations above 3746.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(final_data<span class="sc">$</span>Sum_NB_VALD <span class="sc">~</span> final_data<span class="sc">$</span>HolidayType)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  final_data$Sum_NB_VALD by final_data$HolidayType
t = -140.94, df = 28471, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group Holiday and group Non-Holiday is not equal to 0
95 percent confidence interval:
 -4940.694 -4805.154
sample estimates:
    mean in group Holiday mean in group Non-Holiday 
                 2692.817                  7565.741 </code></pre>
</div>
</div>
<ul>
<li>The p-value is highly significant (p &lt; 0.05), suggesting that there is a significant difference in the number of validations between Holiday and Non-Holiday periods. The confidence interval provides a range for the difference in means, indicating that the mean number of validations is significantly lower during Holiday periods compared to Non-Holiday periods.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(final_data<span class="sc">$</span>Sum_NB_VALD, <span class="at">main =</span> <span class="st">"Histogram of Sum_NB_VALD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="QuartoR_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>We don’t have normality! so we can’t take the t.test results into consideration! ==&gt; we have to use wilcoxon non parametric test.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(Sum_NB_VALD <span class="sc">~</span> HolidayType, <span class="at">data =</span> final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  Sum_NB_VALD by HolidayType
W = 3.4601e+10, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<ul>
<li><p>The results indicate a highly significant p-value (&lt; 2.2e-16), suggesting that there is a significant difference in the location (median) between the groups “Holiday” and “Non-Holiday.”</p></li>
<li><p>We can use the anova test because our data is very huge, we don’t need to check normality!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(Sum_NB_VALD <span class="sc">~</span> Weekday, <span class="at">data =</span> final_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Sum_NB_VALD
               Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Weekday         6 1.7000e+13 2.8333e+12   13444 &lt; 2.2e-16 ***
Residuals 4273996 9.0075e+14 2.1075e+08                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></li>
<li><p>The ANOVA results show a highly significant difference in means across different weekdays. The small p-value (&lt; 0.05) suggests that there is a significant variation in the number of validations between at least two weekdays. The F value is large, further supporting the evidence for a significant difference. The significant result indicates that there are weekday-specific variations in ridership.</p></li>
</ul>
</section>
<section id="shiny-app-deployment" class="level3">
<h3 class="anchored" data-anchor-id="shiny-app-deployment">7. Shiny App Deployment</h3>
<ul>
<li><p>For the deployment we used shinyapps.io you can find the Deployement folder in the github repository that contains the code that we deployed.</p></li>
<li><p>Here is the Link : https://rprojectigm.shinyapps.io/shiny/</p></li>
</ul>
<p><img src="Images/dep.png" class="img-fluid"></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>